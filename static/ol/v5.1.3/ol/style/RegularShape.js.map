{"version":3,"file":"RegularShape.js","sources":["../../../src/ol/style/RegularShape.js"],"sourcesContent":["/**\r\n * @module ol/style/RegularShape\r\n */\r\n\r\nimport {asColorLike} from '../colorlike.js';\r\nimport {createCanvasContext2D} from '../dom.js';\r\nimport {CANVAS_LINE_DASH} from '../has.js';\r\nimport ImageState from '../ImageState.js';\r\nimport {defaultStrokeStyle, defaultFillStyle, defaultLineCap, defaultLineWidth, defaultLineJoin, defaultMiterLimit} from '../render/canvas.js';\r\nimport ImageStyle from '../style/Image.js';\r\n\r\n\r\n/**\r\n * Specify radius for regular polygons, or radius1 and radius2 for stars.\r\n * @typedef {Object} Options\r\n * @property {module:ol/style/Fill} [fill] Fill style.\r\n * @property {number} points Number of points for stars and regular polygons. In case of a polygon, the number of points\r\n * is the number of sides.\r\n * @property {number} [radius] Radius of a regular polygon.\r\n * @property {number} [radius1] Outer radius of a star.\r\n * @property {number} [radius2] Inner radius of a star.\r\n * @property {number} [angle=0] Shape's angle in radians. A value of 0 will have one of the shape's point facing up.\r\n * @property {boolean} [snapToPixel=true] If `true` integral numbers of pixels are used as the X and Y pixel coordinate\r\n * when drawing the shape in the output canvas. If `false` fractional numbers may be used. Using `true` allows for\r\n * \"sharp\" rendering (no blur), while using `false` allows for \"accurate\" rendering. Note that accuracy is important if\r\n * the shape's position is animated. Without it, the shape may jitter noticeably.\r\n * @property {module:ol/style/Stroke} [stroke] Stroke style.\r\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\r\n * @property {boolean} [rotateWithView=false] Whether to rotate the shape with the view.\r\n * @property {module:ol/style/AtlasManager} [atlasManager] The atlas manager to use for this symbol. When\r\n * using WebGL it is recommended to use an atlas manager to avoid texture switching. If an atlas manager is given, the\r\n * symbol is added to an atlas. By default no atlas manager is used.\r\n */\r\n\r\n\r\n/**\r\n * @typedef {Object} RenderOptions\r\n * @property {module:ol/colorlike~ColorLike} [strokeStyle]\r\n * @property {number} strokeWidth\r\n * @property {number} size\r\n * @property {string} lineCap\r\n * @property {Array.<number>} lineDash\r\n * @property {number} lineDashOffset\r\n * @property {string} lineJoin\r\n * @property {number} miterLimit\r\n */\r\n\r\n\r\n/**\r\n * @classdesc\r\n * Set regular shape style for vector features. The resulting shape will be\r\n * a regular polygon when `radius` is provided, or a star when `radius1` and\r\n * `radius2` are provided.\r\n * @api\r\n */\r\nclass RegularShape extends ImageStyle {\r\n  /**\r\n   * @param {module:ol/style/RegularShape~Options} options Options.\r\n   */\r\n  constructor(options) {\r\n    /**\r\n     * @type {boolean}\r\n     */\r\n    const snapToPixel = options.snapToPixel !== undefined ?\r\n      options.snapToPixel : true;\r\n\r\n    /**\r\n     * @type {boolean}\r\n     */\r\n    const rotateWithView = options.rotateWithView !== undefined ?\r\n      options.rotateWithView : false;\r\n\r\n    super({\r\n      opacity: 1,\r\n      rotateWithView: rotateWithView,\r\n      rotation: options.rotation !== undefined ? options.rotation : 0,\r\n      scale: 1,\r\n      snapToPixel: snapToPixel\r\n    });\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<string>}\r\n     */\r\n    this.checksums_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {HTMLCanvasElement}\r\n     */\r\n    this.canvas_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {HTMLCanvasElement}\r\n     */\r\n    this.hitDetectionCanvas_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/style/Fill}\r\n     */\r\n    this.fill_ = options.fill !== undefined ? options.fill : null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<number>}\r\n     */\r\n    this.origin_ = [0, 0];\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.points_ = options.points;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {number}\r\n     */\r\n    this.radius_ = /** @type {number} */ (options.radius !== undefined ?\r\n      options.radius : options.radius1);\r\n\r\n    /**\r\n     * @private\r\n     * @type {number|undefined}\r\n     */\r\n    this.radius2_ = options.radius2;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.angle_ = options.angle !== undefined ? options.angle : 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/style/Stroke}\r\n     */\r\n    this.stroke_ = options.stroke !== undefined ? options.stroke : null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<number>}\r\n     */\r\n    this.anchor_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/size~Size}\r\n     */\r\n    this.size_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/size~Size}\r\n     */\r\n    this.imageSize_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/size~Size}\r\n     */\r\n    this.hitDetectionImageSize_ = null;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {module:ol/style/AtlasManager|undefined}\r\n     */\r\n    this.atlasManager_ = options.atlasManager;\r\n\r\n    this.render_(this.atlasManager_);\r\n\r\n  }\r\n\r\n  /**\r\n   * Clones the style. If an atlasmanager was provided to the original style it will be used in the cloned style, too.\r\n   * @return {module:ol/style/RegularShape} The cloned style.\r\n   * @api\r\n   */\r\n  clone() {\r\n    const style = new RegularShape({\r\n      fill: this.getFill() ? this.getFill().clone() : undefined,\r\n      points: this.getPoints(),\r\n      radius: this.getRadius(),\r\n      radius2: this.getRadius2(),\r\n      angle: this.getAngle(),\r\n      snapToPixel: this.getSnapToPixel(),\r\n      stroke: this.getStroke() ? this.getStroke().clone() : undefined,\r\n      rotation: this.getRotation(),\r\n      rotateWithView: this.getRotateWithView(),\r\n      atlasManager: this.atlasManager_\r\n    });\r\n    style.setOpacity(this.getOpacity());\r\n    style.setScale(this.getScale());\r\n    return style;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @api\r\n   */\r\n  getAnchor() {\r\n    return this.anchor_;\r\n  }\r\n\r\n  /**\r\n   * Get the angle used in generating the shape.\r\n   * @return {number} Shape's rotation in radians.\r\n   * @api\r\n   */\r\n  getAngle() {\r\n    return this.angle_;\r\n  }\r\n\r\n  /**\r\n   * Get the fill style for the shape.\r\n   * @return {module:ol/style/Fill} Fill style.\r\n   * @api\r\n   */\r\n  getFill() {\r\n    return this.fill_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  getHitDetectionImage(pixelRatio) {\r\n    return this.hitDetectionCanvas_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @api\r\n   */\r\n  getImage(pixelRatio) {\r\n    return this.canvas_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  getImageSize() {\r\n    return this.imageSize_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  getHitDetectionImageSize() {\r\n    return this.hitDetectionImageSize_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  getImageState() {\r\n    return ImageState.LOADED;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @api\r\n   */\r\n  getOrigin() {\r\n    return this.origin_;\r\n  }\r\n\r\n  /**\r\n   * Get the number of points for generating the shape.\r\n   * @return {number} Number of points for stars and regular polygons.\r\n   * @api\r\n   */\r\n  getPoints() {\r\n    return this.points_;\r\n  }\r\n\r\n  /**\r\n   * Get the (primary) radius for the shape.\r\n   * @return {number} Radius.\r\n   * @api\r\n   */\r\n  getRadius() {\r\n    return this.radius_;\r\n  }\r\n\r\n  /**\r\n   * Get the secondary radius for the shape.\r\n   * @return {number|undefined} Radius2.\r\n   * @api\r\n   */\r\n  getRadius2() {\r\n    return this.radius2_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   * @api\r\n   */\r\n  getSize() {\r\n    return this.size_;\r\n  }\r\n\r\n  /**\r\n   * Get the stroke style for the shape.\r\n   * @return {module:ol/style/Stroke} Stroke style.\r\n   * @api\r\n   */\r\n  getStroke() {\r\n    return this.stroke_;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  listenImageChange(listener, thisArg) {}\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  load() {}\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  unlistenImageChange(listener, thisArg) {}\r\n\r\n  /**\r\n   * @protected\r\n   * @param {module:ol/style/AtlasManager|undefined} atlasManager An atlas manager.\r\n   */\r\n  render_(atlasManager) {\r\n    let imageSize;\r\n    let lineCap = '';\r\n    let lineJoin = '';\r\n    let miterLimit = 0;\r\n    let lineDash = null;\r\n    let lineDashOffset = 0;\r\n    let strokeStyle;\r\n    let strokeWidth = 0;\r\n\r\n    if (this.stroke_) {\r\n      strokeStyle = this.stroke_.getColor();\r\n      if (strokeStyle === null) {\r\n        strokeStyle = defaultStrokeStyle;\r\n      }\r\n      strokeStyle = asColorLike(strokeStyle);\r\n      strokeWidth = this.stroke_.getWidth();\r\n      if (strokeWidth === undefined) {\r\n        strokeWidth = defaultLineWidth;\r\n      }\r\n      lineDash = this.stroke_.getLineDash();\r\n      lineDashOffset = this.stroke_.getLineDashOffset();\r\n      if (!CANVAS_LINE_DASH) {\r\n        lineDash = null;\r\n        lineDashOffset = 0;\r\n      }\r\n      lineJoin = this.stroke_.getLineJoin();\r\n      if (lineJoin === undefined) {\r\n        lineJoin = defaultLineJoin;\r\n      }\r\n      lineCap = this.stroke_.getLineCap();\r\n      if (lineCap === undefined) {\r\n        lineCap = defaultLineCap;\r\n      }\r\n      miterLimit = this.stroke_.getMiterLimit();\r\n      if (miterLimit === undefined) {\r\n        miterLimit = defaultMiterLimit;\r\n      }\r\n    }\r\n\r\n    let size = 2 * (this.radius_ + strokeWidth) + 1;\r\n\r\n    /** @type {module:ol/style/RegularShape~RenderOptions} */\r\n    const renderOptions = {\r\n      strokeStyle: strokeStyle,\r\n      strokeWidth: strokeWidth,\r\n      size: size,\r\n      lineCap: lineCap,\r\n      lineDash: lineDash,\r\n      lineDashOffset: lineDashOffset,\r\n      lineJoin: lineJoin,\r\n      miterLimit: miterLimit\r\n    };\r\n\r\n    if (atlasManager === undefined) {\r\n      // no atlas manager is used, create a new canvas\r\n      const context = createCanvasContext2D(size, size);\r\n      this.canvas_ = context.canvas;\r\n\r\n      // canvas.width and height are rounded to the closest integer\r\n      size = this.canvas_.width;\r\n      imageSize = size;\r\n\r\n      this.draw_(renderOptions, context, 0, 0);\r\n\r\n      this.createHitDetectionCanvas_(renderOptions);\r\n    } else {\r\n      // an atlas manager is used, add the symbol to an atlas\r\n      size = Math.round(size);\r\n\r\n      const hasCustomHitDetectionImage = !this.fill_;\r\n      let renderHitDetectionCallback;\r\n      if (hasCustomHitDetectionImage) {\r\n        // render the hit-detection image into a separate atlas image\r\n        renderHitDetectionCallback =\r\n            this.drawHitDetectionCanvas_.bind(this, renderOptions);\r\n      }\r\n\r\n      const id = this.getChecksum();\r\n      const info = atlasManager.add(\r\n        id, size, size, this.draw_.bind(this, renderOptions),\r\n        renderHitDetectionCallback);\r\n\r\n      this.canvas_ = info.image;\r\n      this.origin_ = [info.offsetX, info.offsetY];\r\n      imageSize = info.image.width;\r\n\r\n      if (hasCustomHitDetectionImage) {\r\n        this.hitDetectionCanvas_ = info.hitImage;\r\n        this.hitDetectionImageSize_ =\r\n            [info.hitImage.width, info.hitImage.height];\r\n      } else {\r\n        this.hitDetectionCanvas_ = this.canvas_;\r\n        this.hitDetectionImageSize_ = [imageSize, imageSize];\r\n      }\r\n    }\r\n\r\n    this.anchor_ = [size / 2, size / 2];\r\n    this.size_ = [size, size];\r\n    this.imageSize_ = [imageSize, imageSize];\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\r\n   * @param {CanvasRenderingContext2D} context The rendering context.\r\n   * @param {number} x The origin for the symbol (x).\r\n   * @param {number} y The origin for the symbol (y).\r\n   */\r\n  draw_(renderOptions, context, x, y) {\r\n    let i, angle0, radiusC;\r\n    // reset transform\r\n    context.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n    // then move to (x, y)\r\n    context.translate(x, y);\r\n\r\n    context.beginPath();\r\n\r\n    let points = this.points_;\r\n    if (points === Infinity) {\r\n      context.arc(\r\n        renderOptions.size / 2, renderOptions.size / 2,\r\n        this.radius_, 0, 2 * Math.PI, true);\r\n    } else {\r\n      const radius2 = (this.radius2_ !== undefined) ? this.radius2_\r\n        : this.radius_;\r\n      if (radius2 !== this.radius_) {\r\n        points = 2 * points;\r\n      }\r\n      for (i = 0; i <= points; i++) {\r\n        angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\r\n        radiusC = i % 2 === 0 ? this.radius_ : radius2;\r\n        context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\r\n          renderOptions.size / 2 + radiusC * Math.sin(angle0));\r\n      }\r\n    }\r\n\r\n\r\n    if (this.fill_) {\r\n      let color = this.fill_.getColor();\r\n      if (color === null) {\r\n        color = defaultFillStyle;\r\n      }\r\n      context.fillStyle = asColorLike(color);\r\n      context.fill();\r\n    }\r\n    if (this.stroke_) {\r\n      context.strokeStyle = renderOptions.strokeStyle;\r\n      context.lineWidth = renderOptions.strokeWidth;\r\n      if (renderOptions.lineDash) {\r\n        context.setLineDash(renderOptions.lineDash);\r\n        context.lineDashOffset = renderOptions.lineDashOffset;\r\n      }\r\n      context.lineCap = renderOptions.lineCap;\r\n      context.lineJoin = renderOptions.lineJoin;\r\n      context.miterLimit = renderOptions.miterLimit;\r\n      context.stroke();\r\n    }\r\n    context.closePath();\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\r\n   */\r\n  createHitDetectionCanvas_(renderOptions) {\r\n    this.hitDetectionImageSize_ = [renderOptions.size, renderOptions.size];\r\n    if (this.fill_) {\r\n      this.hitDetectionCanvas_ = this.canvas_;\r\n      return;\r\n    }\r\n\r\n    // if no fill style is set, create an extra hit-detection image with a\r\n    // default fill style\r\n    const context = createCanvasContext2D(renderOptions.size, renderOptions.size);\r\n    this.hitDetectionCanvas_ = context.canvas;\r\n\r\n    this.drawHitDetectionCanvas_(renderOptions, context, 0, 0);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {module:ol/style/RegularShape~RenderOptions} renderOptions Render options.\r\n   * @param {CanvasRenderingContext2D} context The context.\r\n   * @param {number} x The origin for the symbol (x).\r\n   * @param {number} y The origin for the symbol (y).\r\n   */\r\n  drawHitDetectionCanvas_(renderOptions, context, x, y) {\r\n    // reset transform\r\n    context.setTransform(1, 0, 0, 1, 0, 0);\r\n\r\n    // then move to (x, y)\r\n    context.translate(x, y);\r\n\r\n    context.beginPath();\r\n\r\n    let points = this.points_;\r\n    if (points === Infinity) {\r\n      context.arc(\r\n        renderOptions.size / 2, renderOptions.size / 2,\r\n        this.radius_, 0, 2 * Math.PI, true);\r\n    } else {\r\n      const radius2 = (this.radius2_ !== undefined) ? this.radius2_\r\n        : this.radius_;\r\n      if (radius2 !== this.radius_) {\r\n        points = 2 * points;\r\n      }\r\n      let i, radiusC, angle0;\r\n      for (i = 0; i <= points; i++) {\r\n        angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\r\n        radiusC = i % 2 === 0 ? this.radius_ : radius2;\r\n        context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\r\n          renderOptions.size / 2 + radiusC * Math.sin(angle0));\r\n      }\r\n    }\r\n\r\n    context.fillStyle = defaultFillStyle;\r\n    context.fill();\r\n    if (this.stroke_) {\r\n      context.strokeStyle = renderOptions.strokeStyle;\r\n      context.lineWidth = renderOptions.strokeWidth;\r\n      if (renderOptions.lineDash) {\r\n        context.setLineDash(renderOptions.lineDash);\r\n        context.lineDashOffset = renderOptions.lineDashOffset;\r\n      }\r\n      context.stroke();\r\n    }\r\n    context.closePath();\r\n  }\r\n\r\n  /**\r\n   * @return {string} The checksum.\r\n   */\r\n  getChecksum() {\r\n    const strokeChecksum = this.stroke_ ?\r\n      this.stroke_.getChecksum() : '-';\r\n    const fillChecksum = this.fill_ ?\r\n      this.fill_.getChecksum() : '-';\r\n\r\n    const recalculate = !this.checksums_ ||\r\n        (strokeChecksum != this.checksums_[1] ||\r\n        fillChecksum != this.checksums_[2] ||\r\n        this.radius_ != this.checksums_[3] ||\r\n        this.radius2_ != this.checksums_[4] ||\r\n        this.angle_ != this.checksums_[5] ||\r\n        this.points_ != this.checksums_[6]);\r\n\r\n    if (recalculate) {\r\n      const checksum = 'r' + strokeChecksum + fillChecksum +\r\n          (this.radius_ !== undefined ? this.radius_.toString() : '-') +\r\n          (this.radius2_ !== undefined ? this.radius2_.toString() : '-') +\r\n          (this.angle_ !== undefined ? this.angle_.toString() : '-') +\r\n          (this.points_ !== undefined ? this.points_.toString() : '-');\r\n      this.checksums_ = [checksum, strokeChecksum, fillChecksum,\r\n        this.radius_, this.radius2_, this.angle_, this.points_];\r\n    }\r\n\r\n    return this.checksums_[0];\r\n  }\r\n}\r\n\r\n\r\nexport default RegularShape;\r\n"],"names":["const","super","let","this"],"mappings":"AAAA;;;;AAIA,QAAQ,WAAW,OAAO,iBAAiB,CAAC;AAC5C,QAAQ,qBAAqB,OAAO,WAAW,CAAC;AAChD,QAAQ,gBAAgB,OAAO,WAAW,CAAC;AAC3C,OAAO,UAAU,MAAM,kBAAkB,CAAC;AAC1C,QAAQ,kBAAkB,EAAE,gBAAgB,EAAE,cAAc,EAAE,gBAAgB,EAAE,eAAe,EAAE,iBAAiB,OAAO,qBAAqB,CAAC;AAC/I,OAAO,UAAU,MAAM,mBAAmB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8C3C,IAAM,YAAY,GAAmB;EAInC,qBAAW,CAAC,OAAO,EAAE;;;;IAInBA,GAAK,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,KAAK,SAAS;MACnD,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC;;;;;IAK7BA,GAAK,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc,KAAK,SAAS;MACzD,OAAO,CAAC,cAAc,GAAG,KAAK,CAAC;;IAEjCC,eAAK,OAAC;MACJ,OAAO,EAAE,CAAC;MACV,cAAc,EAAE,cAAc;MAC9B,QAAQ,EAAE,OAAO,CAAC,QAAQ,KAAK,SAAS,GAAG,OAAO,CAAC,QAAQ,GAAG,CAAC;MAC/D,KAAK,EAAE,CAAC;MACR,WAAW,EAAE,WAAW;KACzB,CAAC,CAAC;;;;;;IAMH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;;;;;;IAMvB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;;;;;;IAMpB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;;;;;;IAMhC,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,IAAI,KAAK,SAAS,GAAG,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;;;;;;IAM9D,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;;;;;IAMtB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;;;;;;IAM9B,IAAI,CAAC,OAAO,yBAAyB,CAAC,OAAO,CAAC,MAAM,KAAK,SAAS;MAChE,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;;;;;;IAMpC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC;;;;;;IAMhC,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,KAAK,KAAK,SAAS,GAAG,OAAO,CAAC,KAAK,GAAG,CAAC,CAAC;;;;;;IAM9D,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,KAAK,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;;;;;;IAMpE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;;;;;;IAMpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;;;;;;IAMlB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;;;;;;IAMvB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;;;;;;IAMnC,IAAI,CAAC,aAAa,GAAG,OAAO,CAAC,YAAY,CAAC;;IAE1C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;;;;;;oDAElC;;;;;;;yBAOD,uBAAK,GAAG;IACND,GAAK,CAAC,KAAK,GAAG,IAAI,YAAY,CAAC;MAC7B,IAAI,EAAE,IAAI,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,KAAK,EAAE,GAAG,SAAS;MACzD,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE;MACxB,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE;MACxB,OAAO,EAAE,IAAI,CAAC,UAAU,EAAE;MAC1B,KAAK,EAAE,IAAI,CAAC,QAAQ,EAAE;MACtB,WAAW,EAAE,IAAI,CAAC,cAAc,EAAE;MAClC,MAAM,EAAE,IAAI,CAAC,SAAS,EAAE,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,GAAG,SAAS;MAC/D,QAAQ,EAAE,IAAI,CAAC,WAAW,EAAE;MAC5B,cAAc,EAAE,IAAI,CAAC,iBAAiB,EAAE;MACxC,YAAY,EAAE,IAAI,CAAC,aAAa;KACjC,CAAC,CAAC;IACH,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC,CAAC;IACpC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;IAChC,OAAO,KAAK,CAAC;IACd;;;;;;yBAMD,+BAAS,GAAG;IACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;;;yBAOD,6BAAQ,GAAG;IACT,OAAO,IAAI,CAAC,MAAM,CAAC;IACpB;;;;;;;yBAOD,2BAAO,GAAG;IACR,OAAO,IAAI,CAAC,KAAK,CAAC;IACnB;;;;;yBAKD,qDAAoB,CAAC,UAAU,EAAE;IAC/B,OAAO,IAAI,CAAC,mBAAmB,CAAC;IACjC;;;;;;yBAMD,6BAAQ,CAAC,UAAU,EAAE;IACnB,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;yBAKD,qCAAY,GAAG;IACb,OAAO,IAAI,CAAC,UAAU,CAAC;IACxB;;;;;yBAKD,6DAAwB,GAAG;IACzB,OAAO,IAAI,CAAC,sBAAsB,CAAC;IACpC;;;;;yBAKD,uCAAa,GAAG;IACd,OAAO,UAAU,CAAC,MAAM,CAAC;IAC1B;;;;;;yBAMD,+BAAS,GAAG;IACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;;;yBAOD,+BAAS,GAAG;IACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;;;yBAOD,+BAAS,GAAG;IACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;;;yBAOD,iCAAU,GAAG;IACX,OAAO,IAAI,CAAC,QAAQ,CAAC;IACtB;;;;;;yBAMD,2BAAO,GAAG;IACR,OAAO,IAAI,CAAC,KAAK,CAAC;IACnB;;;;;;;yBAOD,+BAAS,GAAG;IACV,OAAO,IAAI,CAAC,OAAO,CAAC;IACrB;;;;;yBAKD,+CAAiB,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAE;;;;;yBAKvC,qBAAI,GAAG,GAAE;;;;;yBAKT,mDAAmB,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAE;;;;;;yBAMzC,2BAAO,CAAC,YAAY,EAAE;IACpBE,GAAG,CAAC,SAAS,CAAC;IACdA,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC;IACjBA,GAAG,CAAC,QAAQ,GAAG,EAAE,CAAC;IAClBA,GAAG,CAAC,UAAU,GAAG,CAAC,CAAC;IACnBA,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC;IACpBA,GAAG,CAAC,cAAc,GAAG,CAAC,CAAC;IACvBA,GAAG,CAAC,WAAW,CAAC;IAChBA,GAAG,CAAC,WAAW,GAAG,CAAC,CAAC;;IAEpB,IAAI,IAAI,CAAC,OAAO,EAAE;MAChB,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;MACtC,IAAI,WAAW,KAAK,IAAI,EAAE;QACxB,WAAW,GAAG,kBAAkB,CAAC;OAClC;MACD,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC,CAAC;MACvC,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC;MACtC,IAAI,WAAW,KAAK,SAAS,EAAE;QAC7B,WAAW,GAAG,gBAAgB,CAAC;OAChC;MACD,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;MACtC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;MAClD,IAAI,CAAC,gBAAgB,EAAE;QACrB,QAAQ,GAAG,IAAI,CAAC;QAChB,cAAc,GAAG,CAAC,CAAC;OACpB;MACD,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;MACtC,IAAI,QAAQ,KAAK,SAAS,EAAE;QAC1B,QAAQ,GAAG,eAAe,CAAC;OAC5B;MACD,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC;MACpC,IAAI,OAAO,KAAK,SAAS,EAAE;QACzB,OAAO,GAAG,cAAc,CAAC;OAC1B;MACD,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC;MAC1C,IAAI,UAAU,KAAK,SAAS,EAAE;QAC5B,UAAU,GAAG,iBAAiB,CAAC;OAChC;KACF;;IAEDA,GAAG,CAAC,IAAI,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC;;;IAGhDF,GAAK,CAAC,aAAa,GAAG;MACpB,WAAW,EAAE,WAAW;MACxB,WAAW,EAAE,WAAW;MACxB,IAAI,EAAE,IAAI;MACV,OAAO,EAAE,OAAO;MAChB,QAAQ,EAAE,QAAQ;MAClB,cAAc,EAAE,cAAc;MAC9B,QAAQ,EAAE,QAAQ;MAClB,UAAU,EAAE,UAAU;KACvB,CAAC;;IAEF,IAAI,YAAY,KAAK,SAAS,EAAE;;MAE9BA,GAAK,CAAC,OAAO,GAAG,qBAAqB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;MAClD,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC;;;MAG9B,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC;MAC1B,SAAS,GAAG,IAAI,CAAC;;MAEjB,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;;MAEzC,IAAI,CAAC,yBAAyB,CAAC,aAAa,CAAC,CAAC;KAC/C,MAAM;;MAEL,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;;MAExBA,GAAK,CAAC,0BAA0B,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;MAC/CE,GAAG,CAAC,0BAA0B,CAAC;MAC/B,IAAI,0BAA0B,EAAE;;QAE9B,0BAA0B;YACtB,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,EAAE,aAAa,CAAC,CAAC;OAC5D;;MAEDF,GAAK,CAAC,EAAE,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;MAC9BA,GAAK,CAAC,IAAI,GAAG,YAAY,CAAC,GAAG;QAC3B,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,aAAa,CAAC;QACpD,0BAA0B,CAAC,CAAC;;MAE9B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC;MAC1B,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;MAC5C,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;;MAE7B,IAAI,0BAA0B,EAAE;QAC9B,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,QAAQ,CAAC;QACzC,IAAI,CAAC,sBAAsB;YACvB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;OACjD,MAAM;QACL,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC;QACxC,IAAI,CAAC,sBAAsB,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;OACtD;KACF;;IAED,IAAI,CAAC,OAAO,GAAG,CAAC,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,CAAC,CAAC,CAAC;IACpC,IAAI,CAAC,KAAK,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC1B,IAAI,CAAC,UAAU,GAAG,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IAC1C;;;;;;;;;yBASD,uBAAK,CAAC,aAAa,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE;;AAAC;IACnCE,GAAG,CAAC,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC;;IAEvB,OAAO,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;;;IAGvC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;IAExB,OAAO,CAAC,SAAS,EAAE,CAAC;;IAEpBA,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;IAC1B,IAAI,MAAM,KAAK,QAAQ,EAAE;MACvB,OAAO,CAAC,GAAG;QACT,aAAa,CAAC,IAAI,GAAG,CAAC,EAAE,aAAa,CAAC,IAAI,GAAG,CAAC;QAC9C,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;KACvC,MAAM;MACLF,GAAK,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,CAAC,GAAG,IAAI,CAAC,QAAQ;UACzD,IAAI,CAAC,OAAO,CAAC;MACjB,IAAI,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE;QAC5B,MAAM,GAAG,CAAC,GAAG,MAAM,CAAC;OACrB;MACD,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,MAAM,EAAE,CAAC,EAAE,EAAE;QAC5B,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,GAAGG,MAAI,CAAC,MAAM,CAAC;QAC9D,OAAO,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,GAAGA,MAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAC/C,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;UAChE,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;OACxD;KACF;;;IAGD,IAAI,IAAI,CAAC,KAAK,EAAE;MACdD,GAAG,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;MAClC,IAAI,KAAK,KAAK,IAAI,EAAE;QAClB,KAAK,GAAG,gBAAgB,CAAC;OAC1B;MACD,OAAO,CAAC,SAAS,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC;MACvC,OAAO,CAAC,IAAI,EAAE,CAAC;KAChB;IACD,IAAI,IAAI,CAAC,OAAO,EAAE;MAChB,OAAO,CAAC,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC;MAChD,OAAO,CAAC,SAAS,GAAG,aAAa,CAAC,WAAW,CAAC;MAC9C,IAAI,aAAa,CAAC,QAAQ,EAAE;QAC1B,OAAO,CAAC,WAAW,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAC5C,OAAO,CAAC,cAAc,GAAG,aAAa,CAAC,cAAc,CAAC;OACvD;MACD,OAAO,CAAC,OAAO,GAAG,aAAa,CAAC,OAAO,CAAC;MACxC,OAAO,CAAC,QAAQ,GAAG,aAAa,CAAC,QAAQ,CAAC;MAC1C,OAAO,CAAC,UAAU,GAAG,aAAa,CAAC,UAAU,CAAC;MAC9C,OAAO,CAAC,MAAM,EAAE,CAAC;KAClB;IACD,OAAO,CAAC,SAAS,EAAE,CAAC;IACrB;;;;;;yBAMD,+DAAyB,CAAC,aAAa,EAAE;IACvC,IAAI,CAAC,sBAAsB,GAAG,CAAC,aAAa,CAAC,IAAI,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC;IACvE,IAAI,IAAI,CAAC,KAAK,EAAE;MACd,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC;MACxC,OAAO;KACR;;;;IAIDF,GAAK,CAAC,OAAO,GAAG,qBAAqB,CAAC,aAAa,CAAC,IAAI,EAAE,aAAa,CAAC,IAAI,CAAC,CAAC;IAC9E,IAAI,CAAC,mBAAmB,GAAG,OAAO,CAAC,MAAM,CAAC;;IAE1C,IAAI,CAAC,uBAAuB,CAAC,aAAa,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC5D;;;;;;;;;yBASD,2DAAuB,CAAC,aAAa,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE;;AAAC;;IAErD,OAAO,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;;;IAGvC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;IAExB,OAAO,CAAC,SAAS,EAAE,CAAC;;IAEpBE,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;IAC1B,IAAI,MAAM,KAAK,QAAQ,EAAE;MACvB,OAAO,CAAC,GAAG;QACT,aAAa,CAAC,IAAI,GAAG,CAAC,EAAE,aAAa,CAAC,IAAI,GAAG,CAAC;QAC9C,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;KACvC,MAAM;MACLF,GAAK,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,CAAC,GAAG,IAAI,CAAC,QAAQ;UACzD,IAAI,CAAC,OAAO,CAAC;MACjB,IAAI,OAAO,KAAK,IAAI,CAAC,OAAO,EAAE;QAC5B,MAAM,GAAG,CAAC,GAAG,MAAM,CAAC;OACrB;MACDE,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,MAAM,CAAC;MACvB,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,MAAM,EAAE,CAAC,EAAE,EAAE;QAC5B,MAAM,GAAG,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,GAAG,MAAM,GAAG,IAAI,CAAC,EAAE,GAAG,CAAC,GAAGC,MAAI,CAAC,MAAM,CAAC;QAC9D,OAAO,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,GAAGA,MAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAC/C,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC;UAChE,aAAa,CAAC,IAAI,GAAG,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;OACxD;KACF;;IAED,OAAO,CAAC,SAAS,GAAG,gBAAgB,CAAC;IACrC,OAAO,CAAC,IAAI,EAAE,CAAC;IACf,IAAI,IAAI,CAAC,OAAO,EAAE;MAChB,OAAO,CAAC,WAAW,GAAG,aAAa,CAAC,WAAW,CAAC;MAChD,OAAO,CAAC,SAAS,GAAG,aAAa,CAAC,WAAW,CAAC;MAC9C,IAAI,aAAa,CAAC,QAAQ,EAAE;QAC1B,OAAO,CAAC,WAAW,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAC5C,OAAO,CAAC,cAAc,GAAG,aAAa,CAAC,cAAc,CAAC;OACvD;MACD,OAAO,CAAC,MAAM,EAAE,CAAC;KAClB;IACD,OAAO,CAAC,SAAS,EAAE,CAAC;IACrB;;;;;yBAKD,mCAAW,GAAG;IACZH,GAAK,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO;MACjC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC;IACnCA,GAAK,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK;MAC7B,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC;;IAEjCA,GAAK,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,UAAU;QAChC,CAAC,cAAc,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QACrC,YAAY,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QAClC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QAClC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QACnC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC;QACjC,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;;IAExC,IAAI,WAAW,EAAE;MACfA,GAAK,CAAC,QAAQ,GAAG,GAAG,GAAG,cAAc,GAAG,YAAY;UAChD,CAAC,IAAI,CAAC,OAAO,KAAK,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC;UAC5D,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC;UAC9D,CAAC,IAAI,CAAC,MAAM,KAAK,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC;UAC1D,CAAC,IAAI,CAAC,OAAO,KAAK,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,GAAG,CAAC,CAAC;MACjE,IAAI,CAAC,UAAU,GAAG,CAAC,QAAQ,EAAE,cAAc,EAAE,YAAY;QACvD,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;KAC3D;;IAED,OAAO,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;GAC3B;;;EAvhBwB,aAwhB1B;;;AAGD,eAAe,YAAY,CAAC;"}