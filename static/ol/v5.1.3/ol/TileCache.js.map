{"version":3,"file":"TileCache.js","sources":["../../src/ol/TileCache.js"],"sourcesContent":["/**\r\n * @module ol/TileCache\r\n */\r\nimport LRUCache from './structs/LRUCache.js';\r\nimport {fromKey, getKey} from './tilecoord.js';\r\n\r\nclass TileCache extends LRUCache {\r\n\r\n  /**\r\n   * @param {number=} opt_highWaterMark High water mark.\r\n   */\r\n  constructor(opt_highWaterMark) {\r\n\r\n    super(opt_highWaterMark);\r\n\r\n  }\r\n\r\n  /**\r\n   * @param {!Object.<string, module:ol/TileRange>} usedTiles Used tiles.\r\n   */\r\n  expireCache(usedTiles) {\r\n    while (this.canExpireCache()) {\r\n      const tile = this.peekLast();\r\n      const zKey = tile.tileCoord[0].toString();\r\n      if (zKey in usedTiles && usedTiles[zKey].contains(tile.tileCoord)) {\r\n        break;\r\n      } else {\r\n        this.pop().dispose();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\r\n   */\r\n  pruneExceptNewestZ() {\r\n    if (this.getCount() === 0) {\r\n      return;\r\n    }\r\n    const key = this.peekFirstKey();\r\n    const tileCoord = fromKey(key);\r\n    const z = tileCoord[0];\r\n    this.forEach(function(tile) {\r\n      if (tile.tileCoord[0] !== z) {\r\n        this.remove(getKey(tile.tileCoord));\r\n        tile.dispose();\r\n      }\r\n    }, this);\r\n  }\r\n}\r\n\r\n\r\nexport default TileCache;\r\n"],"names":["super","const","this"],"mappings":"AAAA;;;AAGA,OAAO,QAAQ,MAAM,uBAAuB,CAAC;AAC7C,QAAQ,OAAO,EAAE,MAAM,OAAO,gBAAgB,CAAC;;AAE/C,IAAM,SAAS,GAAiB;EAK9B,kBAAW,CAAC,iBAAiB,EAAE;;IAE7BA,aAAK,OAAC,iBAAiB,CAAC,CAAC;;;;;;8CAE1B;;;;;sBAKD,mCAAW,CAAC,SAAS,EAAE;;AAAC;IACtB,OAAO,IAAI,CAAC,cAAc,EAAE,EAAE;MAC5BC,GAAK,CAAC,IAAI,GAAGC,MAAI,CAAC,QAAQ,EAAE,CAAC;MAC7BD,GAAK,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;MAC1C,IAAI,IAAI,IAAI,SAAS,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;QACjE,MAAM;OACP,MAAM;QACLC,MAAI,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC;OACtB;KACF;IACF;;;;;sBAKD,iDAAkB,GAAG;IACnB,IAAI,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,EAAE;MACzB,OAAO;KACR;IACDD,GAAK,CAAC,GAAG,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;IAChCA,GAAK,CAAC,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;IAC/BA,GAAK,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;IACvB,IAAI,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE;MAC1B,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;QAC3B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QACpC,IAAI,CAAC,OAAO,EAAE,CAAC;OAChB;KACF,EAAE,IAAI,CAAC,CAAC;GACV;;;EA1CqB,WA2CvB;;;AAGD,eAAe,SAAS,CAAC;"}