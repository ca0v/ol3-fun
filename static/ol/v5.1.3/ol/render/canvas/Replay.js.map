{"version":3,"file":"Replay.js","sources":["../../../../src/ol/render/canvas/Replay.js"],"sourcesContent":["/**\r\n * @module ol/render/canvas/Replay\r\n */\r\nimport {getUid} from '../../util.js';\r\nimport {UNDEFINED} from '../../functions.js';\r\nimport {equals, reverseSubArray} from '../../array.js';\r\nimport {asColorLike} from '../../colorlike.js';\r\nimport {buffer, clone, coordinateRelationship, createEmpty, createOrUpdate,\r\n  createOrUpdateEmpty, extend, extendCoordinate, intersects} from '../../extent.js';\r\nimport Relationship from '../../extent/Relationship.js';\r\nimport GeometryType from '../../geom/GeometryType.js';\r\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\r\nimport {lineStringLength} from '../../geom/flat/length.js';\r\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\r\nimport {transform2D} from '../../geom/flat/transform.js';\r\nimport {CANVAS_LINE_DASH} from '../../has.js';\r\nimport {isEmpty} from '../../obj.js';\r\nimport VectorContext from '../VectorContext.js';\r\nimport {drawImage, resetTransform, defaultPadding, defaultFillStyle, defaultStrokeStyle,\r\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\r\n  defaultLineDash, defaultLineCap} from '../canvas.js';\r\nimport CanvasInstruction from '../canvas/Instruction.js';\r\nimport {TEXT_ALIGN} from '../replay.js';\r\nimport {\r\n  create as createTransform,\r\n  compose as composeTransform,\r\n  apply as applyTransform,\r\n  setFromArray as transformSetFromArray\r\n} from '../../transform.js';\r\n\r\n\r\n/**\r\n * @type {module:ol/extent~Extent}\r\n */\r\nconst tmpExtent = createEmpty();\r\n\r\n\r\n/**\r\n * @type {!module:ol/transform~Transform}\r\n */\r\nconst tmpTransform = createTransform();\r\n\r\n\r\nclass CanvasReplay extends VectorContext {\r\n  /**\r\n   * @param {number} tolerance Tolerance.\r\n   * @param {module:ol/extent~Extent} maxExtent Maximum extent.\r\n   * @param {number} resolution Resolution.\r\n   * @param {number} pixelRatio Pixel ratio.\r\n   * @param {boolean} overlaps The replay can have overlapping geometries.\r\n   * @param {?} declutterTree Declutter tree.\r\n   */\r\n  constructor(tolerance, maxExtent, resolution, pixelRatio, overlaps, declutterTree) {\r\n    super();\r\n\r\n    /**\r\n     * @type {?}\r\n     */\r\n    this.declutterTree = declutterTree;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {number}\r\n     */\r\n    this.tolerance = tolerance;\r\n\r\n    /**\r\n     * @protected\r\n     * @const\r\n     * @type {module:ol/extent~Extent}\r\n     */\r\n    this.maxExtent = maxExtent;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {boolean}\r\n     */\r\n    this.overlaps = overlaps;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {number}\r\n     */\r\n    this.pixelRatio = pixelRatio;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {number}\r\n     */\r\n    this.maxLineWidth = 0;\r\n\r\n    /**\r\n     * @protected\r\n     * @const\r\n     * @type {number}\r\n     */\r\n    this.resolution = resolution;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.alignFill_;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<*>}\r\n     */\r\n    this.beginGeometryInstruction1_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<*>}\r\n     */\r\n    this.beginGeometryInstruction2_ = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/extent~Extent}\r\n     */\r\n    this.bufferedMaxExtent_ = null;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {Array.<*>}\r\n     */\r\n    this.instructions = [];\r\n\r\n    /**\r\n     * @protected\r\n     * @type {Array.<number>}\r\n     */\r\n    this.coordinates = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {!Object.<number,module:ol/coordinate~Coordinate|Array.<module:ol/coordinate~Coordinate>|Array.<Array.<module:ol/coordinate~Coordinate>>>}\r\n     */\r\n    this.coordinateCache_ = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {!module:ol/transform~Transform}\r\n     */\r\n    this.renderedTransform_ = createTransform();\r\n\r\n    /**\r\n     * @protected\r\n     * @type {Array.<*>}\r\n     */\r\n    this.hitDetectionInstructions = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<number>}\r\n     */\r\n    this.pixelCoordinates_ = null;\r\n\r\n    /**\r\n     * @protected\r\n     * @type {module:ol/render/canvas~FillStrokeState}\r\n     */\r\n    this.state = /** @type {module:ol/render/canvas~FillStrokeState} */ ({});\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.viewRotation_ = 0;\r\n\r\n  }\r\n\r\n  /**\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {module:ol/coordinate~Coordinate} p1 1st point of the background box.\r\n   * @param {module:ol/coordinate~Coordinate} p2 2nd point of the background box.\r\n   * @param {module:ol/coordinate~Coordinate} p3 3rd point of the background box.\r\n   * @param {module:ol/coordinate~Coordinate} p4 4th point of the background box.\r\n   * @param {Array.<*>} fillInstruction Fill instruction.\r\n   * @param {Array.<*>} strokeInstruction Stroke instruction.\r\n   */\r\n  replayTextBackground_(context, p1, p2, p3, p4, fillInstruction, strokeInstruction) {\r\n    context.beginPath();\r\n    context.moveTo.apply(context, p1);\r\n    context.lineTo.apply(context, p2);\r\n    context.lineTo.apply(context, p3);\r\n    context.lineTo.apply(context, p4);\r\n    context.lineTo.apply(context, p1);\r\n    if (fillInstruction) {\r\n      this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\r\n      this.fill_(context);\r\n    }\r\n    if (strokeInstruction) {\r\n      this.setStrokeStyle_(context, /** @type {Array.<*>} */ (strokeInstruction));\r\n      context.stroke();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {number} x X.\r\n   * @param {number} y Y.\r\n   * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\r\n   * @param {number} anchorX Anchor X.\r\n   * @param {number} anchorY Anchor Y.\r\n   * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\r\n   * @param {number} height Height.\r\n   * @param {number} opacity Opacity.\r\n   * @param {number} originX Origin X.\r\n   * @param {number} originY Origin Y.\r\n   * @param {number} rotation Rotation.\r\n   * @param {number} scale Scale.\r\n   * @param {boolean} snapToPixel Snap to pixel.\r\n   * @param {number} width Width.\r\n   * @param {Array.<number>} padding Padding.\r\n   * @param {Array.<*>} fillInstruction Fill instruction.\r\n   * @param {Array.<*>} strokeInstruction Stroke instruction.\r\n   */\r\n  replayImage_(\r\n    context,\r\n    x,\r\n    y,\r\n    image,\r\n    anchorX,\r\n    anchorY,\r\n    declutterGroup,\r\n    height,\r\n    opacity,\r\n    originX,\r\n    originY,\r\n    rotation,\r\n    scale,\r\n    snapToPixel,\r\n    width,\r\n    padding,\r\n    fillInstruction,\r\n    strokeInstruction\r\n  ) {\r\n    const fillStroke = fillInstruction || strokeInstruction;\r\n    anchorX *= scale;\r\n    anchorY *= scale;\r\n    x -= anchorX;\r\n    y -= anchorY;\r\n\r\n    const w = (width + originX > image.width) ? image.width - originX : width;\r\n    const h = (height + originY > image.height) ? image.height - originY : height;\r\n    const boxW = padding[3] + w * scale + padding[1];\r\n    const boxH = padding[0] + h * scale + padding[2];\r\n    const boxX = x - padding[3];\r\n    const boxY = y - padding[0];\r\n\r\n    /** @type {module:ol/coordinate~Coordinate} */\r\n    let p1;\r\n    /** @type {module:ol/coordinate~Coordinate} */\r\n    let p2;\r\n    /** @type {module:ol/coordinate~Coordinate} */\r\n    let p3;\r\n    /** @type {module:ol/coordinate~Coordinate} */\r\n    let p4;\r\n    if (fillStroke || rotation !== 0) {\r\n      p1 = [boxX, boxY];\r\n      p2 = [boxX + boxW, boxY];\r\n      p3 = [boxX + boxW, boxY + boxH];\r\n      p4 = [boxX, boxY + boxH];\r\n    }\r\n\r\n    let transform = null;\r\n    if (rotation !== 0) {\r\n      const centerX = x + anchorX;\r\n      const centerY = y + anchorY;\r\n      transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\r\n\r\n      createOrUpdateEmpty(tmpExtent);\r\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p1));\r\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p2));\r\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p3));\r\n      extendCoordinate(tmpExtent, applyTransform(tmpTransform, p4));\r\n    } else {\r\n      createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\r\n    }\r\n    const canvas = context.canvas;\r\n    const strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\r\n    const intersects =\r\n        tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\r\n        tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\r\n\r\n    if (snapToPixel) {\r\n      x = Math.round(x);\r\n      y = Math.round(y);\r\n    }\r\n\r\n    if (declutterGroup) {\r\n      if (!intersects && declutterGroup[4] == 1) {\r\n        return;\r\n      }\r\n      extend(declutterGroup, tmpExtent);\r\n      const declutterArgs = intersects ?\r\n        [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\r\n        null;\r\n      if (declutterArgs && fillStroke) {\r\n        declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\r\n      }\r\n      declutterGroup.push(declutterArgs);\r\n    } else if (intersects) {\r\n      if (fillStroke) {\r\n        this.replayTextBackground_(context, p1, p2, p3, p4,\r\n          /** @type {Array.<*>} */ (fillInstruction),\r\n          /** @type {Array.<*>} */ (strokeInstruction));\r\n      }\r\n      drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param {Array.<number>} dashArray Dash array.\r\n   * @return {Array.<number>} Dash array with pixel ratio applied\r\n   */\r\n  applyPixelRatio(dashArray) {\r\n    const pixelRatio = this.pixelRatio;\r\n    return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\r\n      return dash * pixelRatio;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {Array.<number>} flatCoordinates Flat coordinates.\r\n   * @param {number} offset Offset.\r\n   * @param {number} end End.\r\n   * @param {number} stride Stride.\r\n   * @param {boolean} closed Last input coordinate equals first.\r\n   * @param {boolean} skipFirst Skip first coordinate.\r\n   * @protected\r\n   * @return {number} My end.\r\n   */\r\n  appendFlatCoordinates(flatCoordinates, offset, end, stride, closed, skipFirst) {\r\n\r\n    let myEnd = this.coordinates.length;\r\n    const extent = this.getBufferedMaxExtent();\r\n    if (skipFirst) {\r\n      offset += stride;\r\n    }\r\n    const lastCoord = [flatCoordinates[offset], flatCoordinates[offset + 1]];\r\n    const nextCoord = [NaN, NaN];\r\n    let skipped = true;\r\n\r\n    let i, lastRel, nextRel;\r\n    for (i = offset + stride; i < end; i += stride) {\r\n      nextCoord[0] = flatCoordinates[i];\r\n      nextCoord[1] = flatCoordinates[i + 1];\r\n      nextRel = coordinateRelationship(extent, nextCoord);\r\n      if (nextRel !== lastRel) {\r\n        if (skipped) {\r\n          this.coordinates[myEnd++] = lastCoord[0];\r\n          this.coordinates[myEnd++] = lastCoord[1];\r\n        }\r\n        this.coordinates[myEnd++] = nextCoord[0];\r\n        this.coordinates[myEnd++] = nextCoord[1];\r\n        skipped = false;\r\n      } else if (nextRel === Relationship.INTERSECTING) {\r\n        this.coordinates[myEnd++] = nextCoord[0];\r\n        this.coordinates[myEnd++] = nextCoord[1];\r\n        skipped = false;\r\n      } else {\r\n        skipped = true;\r\n      }\r\n      lastCoord[0] = nextCoord[0];\r\n      lastCoord[1] = nextCoord[1];\r\n      lastRel = nextRel;\r\n    }\r\n\r\n    // Last coordinate equals first or only one point to append:\r\n    if ((closed && skipped) || i === offset + stride) {\r\n      this.coordinates[myEnd++] = lastCoord[0];\r\n      this.coordinates[myEnd++] = lastCoord[1];\r\n    }\r\n    return myEnd;\r\n  }\r\n\r\n  /**\r\n   * @param {Array.<number>} flatCoordinates Flat coordinates.\r\n   * @param {number} offset Offset.\r\n   * @param {Array.<number>} ends Ends.\r\n   * @param {number} stride Stride.\r\n   * @param {Array.<number>} replayEnds Replay ends.\r\n   * @return {number} Offset.\r\n   */\r\n  drawCustomCoordinates_(flatCoordinates, offset, ends, stride, replayEnds) {\r\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\r\n      const end = ends[i];\r\n      const replayEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\r\n      replayEnds.push(replayEnd);\r\n      offset = end;\r\n    }\r\n    return offset;\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc.\r\n   */\r\n  drawCustom(geometry, feature, renderer) {\r\n    this.beginGeometry(geometry, feature);\r\n    const type = geometry.getType();\r\n    const stride = geometry.getStride();\r\n    const replayBegin = this.coordinates.length;\r\n    let flatCoordinates, replayEnd, replayEnds, replayEndss;\r\n    let offset;\r\n    if (type == GeometryType.MULTI_POLYGON) {\r\n      geometry = /** @type {module:ol/geom/MultiPolygon} */ (geometry);\r\n      flatCoordinates = geometry.getOrientedFlatCoordinates();\r\n      replayEndss = [];\r\n      const endss = geometry.getEndss();\r\n      offset = 0;\r\n      for (let i = 0, ii = endss.length; i < ii; ++i) {\r\n        const myEnds = [];\r\n        offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\r\n        replayEndss.push(myEnds);\r\n      }\r\n      this.instructions.push([CanvasInstruction.CUSTOM,\r\n        replayBegin, replayEndss, geometry, renderer, inflateMultiCoordinatesArray]);\r\n    } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\r\n      replayEnds = [];\r\n      flatCoordinates = (type == GeometryType.POLYGON) ?\r\n        /** @type {module:ol/geom/Polygon} */ (geometry).getOrientedFlatCoordinates() :\r\n        geometry.getFlatCoordinates();\r\n      offset = this.drawCustomCoordinates_(flatCoordinates, 0,\r\n        /** @type {module:ol/geom/Polygon|module:ol/geom/MultiLineString} */ (geometry).getEnds(),\r\n        stride, replayEnds);\r\n      this.instructions.push([CanvasInstruction.CUSTOM,\r\n        replayBegin, replayEnds, geometry, renderer, inflateCoordinatesArray]);\r\n    } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\r\n      flatCoordinates = geometry.getFlatCoordinates();\r\n      replayEnd = this.appendFlatCoordinates(\r\n        flatCoordinates, 0, flatCoordinates.length, stride, false, false);\r\n      this.instructions.push([CanvasInstruction.CUSTOM,\r\n        replayBegin, replayEnd, geometry, renderer, inflateCoordinates]);\r\n    } else if (type == GeometryType.POINT) {\r\n      flatCoordinates = geometry.getFlatCoordinates();\r\n      this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\r\n      replayEnd = this.coordinates.length;\r\n      this.instructions.push([CanvasInstruction.CUSTOM,\r\n        replayBegin, replayEnd, geometry, renderer]);\r\n    }\r\n    this.endGeometry(geometry, feature);\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\r\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\r\n   */\r\n  beginGeometry(geometry, feature) {\r\n    this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\r\n    this.instructions.push(this.beginGeometryInstruction1_);\r\n    this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0];\r\n    this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   */\r\n  fill_(context) {\r\n    if (this.alignFill_) {\r\n      const origin = applyTransform(this.renderedTransform_, [0, 0]);\r\n      const repeatSize = 512 * this.pixelRatio;\r\n      context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\r\n      context.rotate(this.viewRotation_);\r\n    }\r\n    context.fill();\r\n    if (this.alignFill_) {\r\n      context.setTransform.apply(context, resetTransform);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {Array.<*>} instruction Instruction.\r\n   */\r\n  setStrokeStyle_(context, instruction) {\r\n    context.strokeStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\r\n    context.lineWidth = /** @type {number} */ (instruction[2]);\r\n    context.lineCap = /** @type {string} */ (instruction[3]);\r\n    context.lineJoin = /** @type {string} */ (instruction[4]);\r\n    context.miterLimit = /** @type {number} */ (instruction[5]);\r\n    if (CANVAS_LINE_DASH) {\r\n      context.lineDashOffset = /** @type {number} */ (instruction[7]);\r\n      context.setLineDash(/** @type {Array.<number>} */ (instruction[6]));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~DeclutterGroup} declutterGroup Declutter group.\r\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\r\n   */\r\n  renderDeclutter_(declutterGroup, feature) {\r\n    if (declutterGroup && declutterGroup.length > 5) {\r\n      const groupCount = declutterGroup[4];\r\n      if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\r\n        /** @type {module:ol/structs/RBush~Entry} */\r\n        const box = {\r\n          minX: /** @type {number} */ (declutterGroup[0]),\r\n          minY: /** @type {number} */ (declutterGroup[1]),\r\n          maxX: /** @type {number} */ (declutterGroup[2]),\r\n          maxY: /** @type {number} */ (declutterGroup[3]),\r\n          value: feature\r\n        };\r\n        if (!this.declutterTree.collides(box)) {\r\n          this.declutterTree.insert(box);\r\n          for (let j = 5, jj = declutterGroup.length; j < jj; ++j) {\r\n            const declutterData = /** @type {Array} */ (declutterGroup[j]);\r\n            if (declutterData) {\r\n              if (declutterData.length > 11) {\r\n                this.replayTextBackground_(declutterData[0],\r\n                  declutterData[13], declutterData[14], declutterData[15], declutterData[16],\r\n                  declutterData[11], declutterData[12]);\r\n              }\r\n              drawImage.apply(undefined, declutterData);\r\n            }\r\n          }\r\n        }\r\n        declutterGroup.length = 5;\r\n        createOrUpdateEmpty(declutterGroup);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {module:ol/transform~Transform} transform Transform.\r\n   * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\r\n   *     to skip.\r\n   * @param {Array.<*>} instructions Instructions array.\r\n   * @param {function((module:ol/Feature|module:ol/render/Feature)): T|undefined}\r\n   *     featureCallback Feature callback.\r\n   * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\r\n   *     extent.\r\n   * @return {T|undefined} Callback result.\r\n   * @template T\r\n   */\r\n  replay_(\r\n    context,\r\n    transform,\r\n    skippedFeaturesHash,\r\n    instructions,\r\n    featureCallback,\r\n    opt_hitExtent\r\n  ) {\r\n    /** @type {Array.<number>} */\r\n    let pixelCoordinates;\r\n    if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\r\n      pixelCoordinates = this.pixelCoordinates_;\r\n    } else {\r\n      if (!this.pixelCoordinates_) {\r\n        this.pixelCoordinates_ = [];\r\n      }\r\n      pixelCoordinates = transform2D(\r\n        this.coordinates, 0, this.coordinates.length, 2,\r\n        transform, this.pixelCoordinates_);\r\n      transformSetFromArray(this.renderedTransform_, transform);\r\n    }\r\n    const skipFeatures = !isEmpty(skippedFeaturesHash);\r\n    let i = 0; // instruction index\r\n    const ii = instructions.length; // end of instructions\r\n    let d = 0; // data index\r\n    let dd; // end of per-instruction data\r\n    let anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, image;\r\n    let pendingFill = 0;\r\n    let pendingStroke = 0;\r\n    let lastFillInstruction = null;\r\n    let lastStrokeInstruction = null;\r\n    const coordinateCache = this.coordinateCache_;\r\n    const viewRotation = this.viewRotation_;\r\n\r\n    const state = /** @type {module:ol/render~State} */ ({\r\n      context: context,\r\n      pixelRatio: this.pixelRatio,\r\n      resolution: this.resolution,\r\n      rotation: viewRotation\r\n    });\r\n\r\n    // When the batch size gets too big, performance decreases. 200 is a good\r\n    // balance between batch size and number of fill/stroke instructions.\r\n    const batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\r\n    let /** @type {module:ol/Feature|module:ol/render/Feature} */ feature;\r\n    let x, y;\r\n    while (i < ii) {\r\n      const instruction = instructions[i];\r\n      const type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\r\n      switch (type) {\r\n        case CanvasInstruction.BEGIN_GEOMETRY:\r\n          feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\r\n          if ((skipFeatures &&\r\n              skippedFeaturesHash[getUid(feature).toString()]) ||\r\n              !feature.getGeometry()) {\r\n            i = /** @type {number} */ (instruction[2]);\r\n          } else if (opt_hitExtent !== undefined && !intersects(\r\n            opt_hitExtent, feature.getGeometry().getExtent())) {\r\n            i = /** @type {number} */ (instruction[2]) + 1;\r\n          } else {\r\n            ++i;\r\n          }\r\n          break;\r\n        case CanvasInstruction.BEGIN_PATH:\r\n          if (pendingFill > batchSize) {\r\n            this.fill_(context);\r\n            pendingFill = 0;\r\n          }\r\n          if (pendingStroke > batchSize) {\r\n            context.stroke();\r\n            pendingStroke = 0;\r\n          }\r\n          if (!pendingFill && !pendingStroke) {\r\n            context.beginPath();\r\n            prevX = prevY = NaN;\r\n          }\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.CIRCLE:\r\n          d = /** @type {number} */ (instruction[1]);\r\n          const x1 = pixelCoordinates[d];\r\n          const y1 = pixelCoordinates[d + 1];\r\n          const x2 = pixelCoordinates[d + 2];\r\n          const y2 = pixelCoordinates[d + 3];\r\n          const dx = x2 - x1;\r\n          const dy = y2 - y1;\r\n          const r = Math.sqrt(dx * dx + dy * dy);\r\n          context.moveTo(x1 + r, y1);\r\n          context.arc(x1, y1, r, 0, 2 * Math.PI, true);\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.CLOSE_PATH:\r\n          context.closePath();\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.CUSTOM:\r\n          d = /** @type {number} */ (instruction[1]);\r\n          dd = instruction[2];\r\n          const geometry = /** @type {module:ol/geom/SimpleGeometry} */ (instruction[3]);\r\n          const renderer = instruction[4];\r\n          const fn = instruction.length == 6 ? instruction[5] : undefined;\r\n          state.geometry = geometry;\r\n          state.feature = feature;\r\n          if (!(i in coordinateCache)) {\r\n            coordinateCache[i] = [];\r\n          }\r\n          const coords = coordinateCache[i];\r\n          if (fn) {\r\n            fn(pixelCoordinates, d, dd, 2, coords);\r\n          } else {\r\n            coords[0] = pixelCoordinates[d];\r\n            coords[1] = pixelCoordinates[d + 1];\r\n            coords.length = 2;\r\n          }\r\n          renderer(coords, state);\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.DRAW_IMAGE:\r\n          d = /** @type {number} */ (instruction[1]);\r\n          dd = /** @type {number} */ (instruction[2]);\r\n          image = /** @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} */\r\n              (instruction[3]);\r\n          // Remaining arguments in DRAW_IMAGE are in alphabetical order\r\n          anchorX = /** @type {number} */ (instruction[4]);\r\n          anchorY = /** @type {number} */ (instruction[5]);\r\n          declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[6]);\r\n          const height = /** @type {number} */ (instruction[7]);\r\n          const opacity = /** @type {number} */ (instruction[8]);\r\n          const originX = /** @type {number} */ (instruction[9]);\r\n          const originY = /** @type {number} */ (instruction[10]);\r\n          const rotateWithView = /** @type {boolean} */ (instruction[11]);\r\n          let rotation = /** @type {number} */ (instruction[12]);\r\n          const scale = /** @type {number} */ (instruction[13]);\r\n          const snapToPixel = /** @type {boolean} */ (instruction[14]);\r\n          const width = /** @type {number} */ (instruction[15]);\r\n\r\n          let padding, backgroundFill, backgroundStroke;\r\n          if (instruction.length > 16) {\r\n            padding = /** @type {Array.<number>} */ (instruction[16]);\r\n            backgroundFill = /** @type {boolean} */ (instruction[17]);\r\n            backgroundStroke = /** @type {boolean} */ (instruction[18]);\r\n          } else {\r\n            padding = defaultPadding;\r\n            backgroundFill = backgroundStroke = false;\r\n          }\r\n\r\n          if (rotateWithView) {\r\n            rotation += viewRotation;\r\n          }\r\n          for (; d < dd; d += 2) {\r\n            this.replayImage_(context,\r\n              pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\r\n              declutterGroup, height, opacity, originX, originY, rotation, scale,\r\n              snapToPixel, width, padding,\r\n              backgroundFill ? /** @type {Array.<*>} */ (lastFillInstruction) : null,\r\n              backgroundStroke ? /** @type {Array.<*>} */ (lastStrokeInstruction) : null);\r\n          }\r\n          this.renderDeclutter_(declutterGroup, feature);\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.DRAW_CHARS:\r\n          const begin = /** @type {number} */ (instruction[1]);\r\n          const end = /** @type {number} */ (instruction[2]);\r\n          const baseline = /** @type {number} */ (instruction[3]);\r\n          declutterGroup = featureCallback ? null : /** @type {module:ol/render/canvas~DeclutterGroup} */ (instruction[4]);\r\n          const overflow = /** @type {number} */ (instruction[5]);\r\n          const fillKey = /** @type {string} */ (instruction[6]);\r\n          const maxAngle = /** @type {number} */ (instruction[7]);\r\n          const measure = /** @type {function(string):number} */ (instruction[8]);\r\n          const offsetY = /** @type {number} */ (instruction[9]);\r\n          const strokeKey = /** @type {string} */ (instruction[10]);\r\n          const strokeWidth = /** @type {number} */ (instruction[11]);\r\n          const text = /** @type {string} */ (instruction[12]);\r\n          const textKey = /** @type {string} */ (instruction[13]);\r\n          const textScale = /** @type {number} */ (instruction[14]);\r\n\r\n          const pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\r\n          const textLength = measure(text);\r\n          if (overflow || textLength <= pathLength) {\r\n            const textAlign = /** @type {module:ol~render} */ (this).textStates[textKey].textAlign;\r\n            const startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\r\n            const parts = drawTextOnPath(\r\n              pixelCoordinates, begin, end, 2, text, measure, startM, maxAngle);\r\n            if (parts) {\r\n              let c, cc, chars, label, part;\r\n              if (strokeKey) {\r\n                for (c = 0, cc = parts.length; c < cc; ++c) {\r\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\r\n                  chars = /** @type {string} */ (part[4]);\r\n                  label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, '', strokeKey);\r\n                  anchorX = /** @type {number} */ (part[2]) + strokeWidth;\r\n                  anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\r\n                  this.replayImage_(context,\r\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\r\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\r\n                    /** @type {number} */ (part[3]), textScale, false, label.width,\r\n                    defaultPadding, null, null);\r\n                }\r\n              }\r\n              if (fillKey) {\r\n                for (c = 0, cc = parts.length; c < cc; ++c) {\r\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\r\n                  chars = /** @type {string} */ (part[4]);\r\n                  label = /** @type {module:ol~render} */ (this).getImage(chars, textKey, fillKey, '');\r\n                  anchorX = /** @type {number} */ (part[2]);\r\n                  anchorY = baseline * label.height - offsetY;\r\n                  this.replayImage_(context,\r\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\r\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\r\n                    /** @type {number} */ (part[3]), textScale, false, label.width,\r\n                    defaultPadding, null, null);\r\n                }\r\n              }\r\n            }\r\n          }\r\n          this.renderDeclutter_(declutterGroup, feature);\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.END_GEOMETRY:\r\n          if (featureCallback !== undefined) {\r\n            feature = /** @type {module:ol/Feature|module:ol/render/Feature} */ (instruction[1]);\r\n            const result = featureCallback(feature);\r\n            if (result) {\r\n              return result;\r\n            }\r\n          }\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.FILL:\r\n          if (batchSize) {\r\n            pendingFill++;\r\n          } else {\r\n            this.fill_(context);\r\n          }\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.MOVE_TO_LINE_TO:\r\n          d = /** @type {number} */ (instruction[1]);\r\n          dd = /** @type {number} */ (instruction[2]);\r\n          x = pixelCoordinates[d];\r\n          y = pixelCoordinates[d + 1];\r\n          roundX = (x + 0.5) | 0;\r\n          roundY = (y + 0.5) | 0;\r\n          if (roundX !== prevX || roundY !== prevY) {\r\n            context.moveTo(x, y);\r\n            prevX = roundX;\r\n            prevY = roundY;\r\n          }\r\n          for (d += 2; d < dd; d += 2) {\r\n            x = pixelCoordinates[d];\r\n            y = pixelCoordinates[d + 1];\r\n            roundX = (x + 0.5) | 0;\r\n            roundY = (y + 0.5) | 0;\r\n            if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\r\n              context.lineTo(x, y);\r\n              prevX = roundX;\r\n              prevY = roundY;\r\n            }\r\n          }\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.SET_FILL_STYLE:\r\n          lastFillInstruction = instruction;\r\n          this.alignFill_ = instruction[2];\r\n\r\n          if (pendingFill) {\r\n            this.fill_(context);\r\n            pendingFill = 0;\r\n            if (pendingStroke) {\r\n              context.stroke();\r\n              pendingStroke = 0;\r\n            }\r\n          }\r\n\r\n          context.fillStyle = /** @type {module:ol/colorlike~ColorLike} */ (instruction[1]);\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.SET_STROKE_STYLE:\r\n          lastStrokeInstruction = instruction;\r\n          if (pendingStroke) {\r\n            context.stroke();\r\n            pendingStroke = 0;\r\n          }\r\n          this.setStrokeStyle_(context, /** @type {Array.<*>} */ (instruction));\r\n          ++i;\r\n          break;\r\n        case CanvasInstruction.STROKE:\r\n          if (batchSize) {\r\n            pendingStroke++;\r\n          } else {\r\n            context.stroke();\r\n          }\r\n          ++i;\r\n          break;\r\n        default:\r\n          ++i; // consume the instruction anyway, to avoid an infinite loop\r\n          break;\r\n      }\r\n    }\r\n    if (pendingFill) {\r\n      this.fill_(context);\r\n    }\r\n    if (pendingStroke) {\r\n      context.stroke();\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {module:ol/transform~Transform} transform Transform.\r\n   * @param {number} viewRotation View rotation.\r\n   * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\r\n   *     to skip.\r\n   */\r\n  replay(context, transform, viewRotation, skippedFeaturesHash) {\r\n    this.viewRotation_ = viewRotation;\r\n    this.replay_(context, transform,\r\n      skippedFeaturesHash, this.instructions, undefined, undefined);\r\n  }\r\n\r\n  /**\r\n   * @param {CanvasRenderingContext2D} context Context.\r\n   * @param {module:ol/transform~Transform} transform Transform.\r\n   * @param {number} viewRotation View rotation.\r\n   * @param {Object.<string, boolean>} skippedFeaturesHash Ids of features\r\n   *     to skip.\r\n   * @param {function((module:ol/Feature|module:ol/render/Feature)): T=} opt_featureCallback\r\n   *     Feature callback.\r\n   * @param {module:ol/extent~Extent=} opt_hitExtent Only check features that intersect this\r\n   *     extent.\r\n   * @return {T|undefined} Callback result.\r\n   * @template T\r\n   */\r\n  replayHitDetection(\r\n    context,\r\n    transform,\r\n    viewRotation,\r\n    skippedFeaturesHash,\r\n    opt_featureCallback,\r\n    opt_hitExtent\r\n  ) {\r\n    this.viewRotation_ = viewRotation;\r\n    return this.replay_(context, transform, skippedFeaturesHash,\r\n      this.hitDetectionInstructions, opt_featureCallback, opt_hitExtent);\r\n  }\r\n\r\n  /**\r\n   * Reverse the hit detection instructions.\r\n   */\r\n  reverseHitDetectionInstructions() {\r\n    const hitDetectionInstructions = this.hitDetectionInstructions;\r\n    // step 1 - reverse array\r\n    hitDetectionInstructions.reverse();\r\n    // step 2 - reverse instructions within geometry blocks\r\n    let i;\r\n    const n = hitDetectionInstructions.length;\r\n    let instruction;\r\n    let type;\r\n    let begin = -1;\r\n    for (i = 0; i < n; ++i) {\r\n      instruction = hitDetectionInstructions[i];\r\n      type = /** @type {module:ol/render/canvas/Instruction} */ (instruction[0]);\r\n      if (type == CanvasInstruction.END_GEOMETRY) {\r\n        begin = i;\r\n      } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\r\n        instruction[2] = i;\r\n        reverseSubArray(this.hitDetectionInstructions, begin, i);\r\n        begin = -1;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @inheritDoc\r\n   */\r\n  setFillStrokeStyle(fillStyle, strokeStyle) {\r\n    const state = this.state;\r\n    if (fillStyle) {\r\n      const fillStyleColor = fillStyle.getColor();\r\n      state.fillStyle = asColorLike(fillStyleColor ?\r\n        fillStyleColor : defaultFillStyle);\r\n    } else {\r\n      state.fillStyle = undefined;\r\n    }\r\n    if (strokeStyle) {\r\n      const strokeStyleColor = strokeStyle.getColor();\r\n      state.strokeStyle = asColorLike(strokeStyleColor ?\r\n        strokeStyleColor : defaultStrokeStyle);\r\n      const strokeStyleLineCap = strokeStyle.getLineCap();\r\n      state.lineCap = strokeStyleLineCap !== undefined ?\r\n        strokeStyleLineCap : defaultLineCap;\r\n      const strokeStyleLineDash = strokeStyle.getLineDash();\r\n      state.lineDash = strokeStyleLineDash ?\r\n        strokeStyleLineDash.slice() : defaultLineDash;\r\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\r\n      state.lineDashOffset = strokeStyleLineDashOffset ?\r\n        strokeStyleLineDashOffset : defaultLineDashOffset;\r\n      const strokeStyleLineJoin = strokeStyle.getLineJoin();\r\n      state.lineJoin = strokeStyleLineJoin !== undefined ?\r\n        strokeStyleLineJoin : defaultLineJoin;\r\n      const strokeStyleWidth = strokeStyle.getWidth();\r\n      state.lineWidth = strokeStyleWidth !== undefined ?\r\n        strokeStyleWidth : defaultLineWidth;\r\n      const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\r\n      state.miterLimit = strokeStyleMiterLimit !== undefined ?\r\n        strokeStyleMiterLimit : defaultMiterLimit;\r\n\r\n      if (state.lineWidth > this.maxLineWidth) {\r\n        this.maxLineWidth = state.lineWidth;\r\n        // invalidate the buffered max extent cache\r\n        this.bufferedMaxExtent_ = null;\r\n      }\r\n    } else {\r\n      state.strokeStyle = undefined;\r\n      state.lineCap = undefined;\r\n      state.lineDash = null;\r\n      state.lineDashOffset = undefined;\r\n      state.lineJoin = undefined;\r\n      state.lineWidth = undefined;\r\n      state.miterLimit = undefined;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~FillStrokeState} state State.\r\n   * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\r\n   * @return {Array.<*>} Fill instruction.\r\n   */\r\n  createFill(state, geometry) {\r\n    const fillStyle = state.fillStyle;\r\n    const fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\r\n    if (typeof fillStyle !== 'string') {\r\n      // Fill is a pattern or gradient - align it!\r\n      fillInstruction.push(true);\r\n    }\r\n    return fillInstruction;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~FillStrokeState} state State.\r\n   */\r\n  applyStroke(state) {\r\n    this.instructions.push(this.createStroke(state));\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~FillStrokeState} state State.\r\n   * @return {Array.<*>} Stroke instruction.\r\n   */\r\n  createStroke(state) {\r\n    return [\r\n      CanvasInstruction.SET_STROKE_STYLE,\r\n      state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\r\n      state.lineJoin, state.miterLimit,\r\n      this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\r\n    ];\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~FillStrokeState} state State.\r\n   * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState, (module:ol/geom/Geometry|module:ol/render/Feature)):Array.<*>} createFill Create fill.\r\n   * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\r\n   */\r\n  updateFillStyle(state, createFill, geometry) {\r\n    const fillStyle = state.fillStyle;\r\n    if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\r\n      if (fillStyle !== undefined) {\r\n        this.instructions.push(createFill.call(this, state, geometry));\r\n      }\r\n      state.currentFillStyle = fillStyle;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/canvas~FillStrokeState} state State.\r\n   * @param {function(this:module:ol/render/canvas/Replay, module:ol/render/canvas~FillStrokeState)} applyStroke Apply stroke.\r\n   */\r\n  updateStrokeStyle(state, applyStroke) {\r\n    const strokeStyle = state.strokeStyle;\r\n    const lineCap = state.lineCap;\r\n    const lineDash = state.lineDash;\r\n    const lineDashOffset = state.lineDashOffset;\r\n    const lineJoin = state.lineJoin;\r\n    const lineWidth = state.lineWidth;\r\n    const miterLimit = state.miterLimit;\r\n    if (state.currentStrokeStyle != strokeStyle ||\r\n        state.currentLineCap != lineCap ||\r\n        (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\r\n        state.currentLineDashOffset != lineDashOffset ||\r\n        state.currentLineJoin != lineJoin ||\r\n        state.currentLineWidth != lineWidth ||\r\n        state.currentMiterLimit != miterLimit) {\r\n      if (strokeStyle !== undefined) {\r\n        applyStroke.call(this, state);\r\n      }\r\n      state.currentStrokeStyle = strokeStyle;\r\n      state.currentLineCap = lineCap;\r\n      state.currentLineDash = lineDash;\r\n      state.currentLineDashOffset = lineDashOffset;\r\n      state.currentLineJoin = lineJoin;\r\n      state.currentLineWidth = lineWidth;\r\n      state.currentMiterLimit = miterLimit;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/geom/Geometry|module:ol/render/Feature} geometry Geometry.\r\n   * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\r\n   */\r\n  endGeometry(geometry, feature) {\r\n    this.beginGeometryInstruction1_[2] = this.instructions.length;\r\n    this.beginGeometryInstruction1_ = null;\r\n    this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\r\n    this.beginGeometryInstruction2_ = null;\r\n    const endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\r\n    this.instructions.push(endGeometryInstruction);\r\n    this.hitDetectionInstructions.push(endGeometryInstruction);\r\n  }\r\n\r\n  /**\r\n   * Get the buffered rendering extent.  Rendering will be clipped to the extent\r\n   * provided to the constructor.  To account for symbolizers that may intersect\r\n   * this extent, we calculate a buffered extent (e.g. based on stroke width).\r\n   * @return {module:ol/extent~Extent} The buffered rendering extent.\r\n   * @protected\r\n   */\r\n  getBufferedMaxExtent() {\r\n    if (!this.bufferedMaxExtent_) {\r\n      this.bufferedMaxExtent_ = clone(this.maxExtent);\r\n      if (this.maxLineWidth > 0) {\r\n        const width = this.resolution * (this.maxLineWidth + 1) / 2;\r\n        buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\r\n      }\r\n    }\r\n    return this.bufferedMaxExtent_;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * FIXME empty description for jsdoc\r\n */\r\nCanvasReplay.prototype.finish = UNDEFINED;\r\n\r\n\r\nexport default CanvasReplay;\r\n"],"names":["const","super","let","this"],"mappings":"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"}