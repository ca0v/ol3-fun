{"version":3,"file":"Map.js","sources":["../../../src/ol/renderer/Map.js"],"sourcesContent":["/**\r\n * @module ol/renderer/Map\r\n */\r\nimport {getUid} from '../util.js';\r\nimport Disposable from '../Disposable.js';\r\nimport {listen, unlistenByKey} from '../events.js';\r\nimport EventType from '../events/EventType.js';\r\nimport {getWidth} from '../extent.js';\r\nimport {TRUE, UNDEFINED} from '../functions.js';\r\nimport {visibleAtResolution} from '../layer/Layer.js';\r\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\r\nimport {compose as composeTransform, invert as invertTransform, setFromArray as transformSetFromArray} from '../transform.js';\r\n\r\n\r\nclass MapRenderer extends Disposable {\r\n\r\n  /**\r\n   * @param {module:ol/PluggableMap} map Map.\r\n   */\r\n  constructor(map) {\r\n    super();\r\n\r\n    /**\r\n     * @private\r\n     * @type {module:ol/PluggableMap}\r\n     */\r\n    this.map_ = map;\r\n\r\n    /**\r\n     * @private\r\n     * @type {!Object.<string, module:ol/renderer/Layer>}\r\n     */\r\n    this.layerRenderers_ = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {Object.<string, module:ol/events~EventsKey>}\r\n     */\r\n    this.layerRendererListeners_ = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array.<module:ol/renderer/Layer>}\r\n     */\r\n    this.layerRendererConstructors_ = [];\r\n\r\n  }\r\n\r\n  /**\r\n   * Register layer renderer constructors.\r\n   * @param {Array.<module:ol/renderer/Layer>} constructors Layer renderers.\r\n   */\r\n  registerLayerRenderers(constructors) {\r\n    this.layerRendererConstructors_.push.apply(this.layerRendererConstructors_, constructors);\r\n  }\r\n\r\n  /**\r\n   * Get the registered layer renderer constructors.\r\n   * @return {Array.<module:ol/renderer/Layer>} Registered layer renderers.\r\n   */\r\n  getLayerRendererConstructors() {\r\n    return this.layerRendererConstructors_;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\r\n   * @protected\r\n   */\r\n  calculateMatrices2D(frameState) {\r\n    const viewState = frameState.viewState;\r\n    const coordinateToPixelTransform = frameState.coordinateToPixelTransform;\r\n    const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\r\n\r\n    composeTransform(coordinateToPixelTransform,\r\n      frameState.size[0] / 2, frameState.size[1] / 2,\r\n      1 / viewState.resolution, -1 / viewState.resolution,\r\n      -viewState.rotation,\r\n      -viewState.center[0], -viewState.center[1]);\r\n\r\n    invertTransform(\r\n      transformSetFromArray(pixelToCoordinateTransform, coordinateToPixelTransform));\r\n  }\r\n\r\n  /**\r\n   * Removes all layer renderers.\r\n   */\r\n  removeLayerRenderers() {\r\n    for (const key in this.layerRenderers_) {\r\n      this.removeLayerRendererByKey_(key).dispose();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\r\n   * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\r\n   * @param {number} hitTolerance Hit tolerance in pixels.\r\n   * @param {function(this: S, (module:ol/Feature|module:ol/render/Feature),\r\n   *     module:ol/layer/Layer): T} callback Feature callback.\r\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\r\n   * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\r\n   *     function, only layers which are visible and for which this function\r\n   *     returns `true` will be tested for features.  By default, all visible\r\n   *     layers will be tested.\r\n   * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\r\n   * @return {T|undefined} Callback result.\r\n   * @template S,T,U\r\n   */\r\n  forEachFeatureAtCoordinate(\r\n    coordinate,\r\n    frameState,\r\n    hitTolerance,\r\n    callback,\r\n    thisArg,\r\n    layerFilter,\r\n    thisArg2\r\n  ) {\r\n    let result;\r\n    const viewState = frameState.viewState;\r\n    const viewResolution = viewState.resolution;\r\n\r\n    /**\r\n     * @param {module:ol/Feature|module:ol/render/Feature} feature Feature.\r\n     * @param {module:ol/layer/Layer} layer Layer.\r\n     * @return {?} Callback result.\r\n     */\r\n    function forEachFeatureAtCoordinate(feature, layer) {\r\n      const key = getUid(feature).toString();\r\n      const managed = frameState.layerStates[getUid(layer)].managed;\r\n      if (!(key in frameState.skippedFeatureUids && !managed)) {\r\n        return callback.call(thisArg, feature, managed ? layer : null);\r\n      }\r\n    }\r\n\r\n    const projection = viewState.projection;\r\n\r\n    let translatedCoordinate = coordinate;\r\n    if (projection.canWrapX()) {\r\n      const projectionExtent = projection.getExtent();\r\n      const worldWidth = getWidth(projectionExtent);\r\n      const x = coordinate[0];\r\n      if (x < projectionExtent[0] || x > projectionExtent[2]) {\r\n        const worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\r\n        translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\r\n      }\r\n    }\r\n\r\n    const layerStates = frameState.layerStatesArray;\r\n    const numLayers = layerStates.length;\r\n    let i;\r\n    for (i = numLayers - 1; i >= 0; --i) {\r\n      const layerState = layerStates[i];\r\n      const layer = layerState.layer;\r\n      if (visibleAtResolution(layerState, viewResolution) && layerFilter.call(thisArg2, layer)) {\r\n        const layerRenderer = this.getLayerRenderer(layer);\r\n        if (layer.getSource()) {\r\n          result = layerRenderer.forEachFeatureAtCoordinate(\r\n            layer.getSource().getWrapX() ? translatedCoordinate : coordinate,\r\n            frameState, hitTolerance, forEachFeatureAtCoordinate, thisArg);\r\n        }\r\n        if (result) {\r\n          return result;\r\n        }\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * @abstract\r\n   * @param {module:ol/pixel~Pixel} pixel Pixel.\r\n   * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\r\n   * @param {number} hitTolerance Hit tolerance in pixels.\r\n   * @param {function(this: S, module:ol/layer/Layer, (Uint8ClampedArray|Uint8Array)): T} callback Layer\r\n   *     callback.\r\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\r\n   * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\r\n   *     function, only layers which are visible and for which this function\r\n   *     returns `true` will be tested for features.  By default, all visible\r\n   *     layers will be tested.\r\n   * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\r\n   * @return {T|undefined} Callback result.\r\n   * @template S,T,U\r\n   */\r\n  forEachLayerAtPixel(pixel, frameState, hitTolerance, callback, thisArg, layerFilter, thisArg2) {}\r\n\r\n  /**\r\n   * @param {module:ol/coordinate~Coordinate} coordinate Coordinate.\r\n   * @param {module:ol/PluggableMap~FrameState} frameState FrameState.\r\n   * @param {number} hitTolerance Hit tolerance in pixels.\r\n   * @param {function(this: U, module:ol/layer/Layer): boolean} layerFilter Layer filter\r\n   *     function, only layers which are visible and for which this function\r\n   *     returns `true` will be tested for features.  By default, all visible\r\n   *     layers will be tested.\r\n   * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\r\n   * @return {boolean} Is there a feature at the given coordinate?\r\n   * @template U\r\n   */\r\n  hasFeatureAtCoordinate(coordinate, frameState, hitTolerance, layerFilter, thisArg) {\r\n    const hasFeature = this.forEachFeatureAtCoordinate(\r\n      coordinate, frameState, hitTolerance, TRUE, this, layerFilter, thisArg);\r\n\r\n    return hasFeature !== undefined;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/layer/Layer} layer Layer.\r\n   * @protected\r\n   * @return {module:ol/renderer/Layer} Layer renderer.\r\n   */\r\n  getLayerRenderer(layer) {\r\n    const layerKey = getUid(layer).toString();\r\n    if (layerKey in this.layerRenderers_) {\r\n      return this.layerRenderers_[layerKey];\r\n    } else {\r\n      let renderer;\r\n      for (let i = 0, ii = this.layerRendererConstructors_.length; i < ii; ++i) {\r\n        const candidate = this.layerRendererConstructors_[i];\r\n        if (candidate['handles'](layer)) {\r\n          renderer = candidate['create'](this, layer);\r\n          break;\r\n        }\r\n      }\r\n      if (renderer) {\r\n        this.layerRenderers_[layerKey] = renderer;\r\n        this.layerRendererListeners_[layerKey] = listen(renderer,\r\n          EventType.CHANGE, this.handleLayerRendererChange_, this);\r\n      } else {\r\n        throw new Error('Unable to create renderer for layer: ' + layer.getType());\r\n      }\r\n      return renderer;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {string} layerKey Layer key.\r\n   * @protected\r\n   * @return {module:ol/renderer/Layer} Layer renderer.\r\n   */\r\n  getLayerRendererByKey(layerKey) {\r\n    return this.layerRenderers_[layerKey];\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @return {Object.<string, module:ol/renderer/Layer>} Layer renderers.\r\n   */\r\n  getLayerRenderers() {\r\n    return this.layerRenderers_;\r\n  }\r\n\r\n  /**\r\n   * @return {module:ol/PluggableMap} Map.\r\n   */\r\n  getMap() {\r\n    return this.map_;\r\n  }\r\n\r\n  /**\r\n   * Handle changes in a layer renderer.\r\n   * @private\r\n   */\r\n  handleLayerRendererChange_() {\r\n    this.map_.render();\r\n  }\r\n\r\n  /**\r\n   * @param {string} layerKey Layer key.\r\n   * @return {module:ol/renderer/Layer} Layer renderer.\r\n   * @private\r\n   */\r\n  removeLayerRendererByKey_(layerKey) {\r\n    const layerRenderer = this.layerRenderers_[layerKey];\r\n    delete this.layerRenderers_[layerKey];\r\n\r\n    unlistenByKey(this.layerRendererListeners_[layerKey]);\r\n    delete this.layerRendererListeners_[layerKey];\r\n\r\n    return layerRenderer;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/PluggableMap} map Map.\r\n   * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\r\n   * @private\r\n   */\r\n  removeUnusedLayerRenderers_(map, frameState) {\r\n    for (const layerKey in this.layerRenderers_) {\r\n      if (!frameState || !(layerKey in frameState.layerStates)) {\r\n        this.removeLayerRendererByKey_(layerKey).dispose();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\r\n   * @protected\r\n   */\r\n  scheduleExpireIconCache(frameState) {\r\n    frameState.postRenderFunctions.push(/** @type {module:ol/PluggableMap~PostRenderFunction} */ (expireIconCache));\r\n  }\r\n\r\n  /**\r\n   * @param {!module:ol/PluggableMap~FrameState} frameState Frame state.\r\n   * @protected\r\n   */\r\n  scheduleRemoveUnusedLayerRenderers(frameState) {\r\n    for (const layerKey in this.layerRenderers_) {\r\n      if (!(layerKey in frameState.layerStates)) {\r\n        frameState.postRenderFunctions.push(\r\n          /** @type {module:ol/PluggableMap~PostRenderFunction} */ (this.removeUnusedLayerRenderers_.bind(this))\r\n        );\r\n        return;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @param {module:ol/PluggableMap} map Map.\r\n * @param {module:ol/PluggableMap~FrameState} frameState Frame state.\r\n */\r\nfunction expireIconCache(map, frameState) {\r\n  iconImageCache.expire();\r\n}\r\n\r\n\r\n/**\r\n * Render.\r\n * @param {?module:ol/PluggableMap~FrameState} frameState Frame state.\r\n */\r\nMapRenderer.prototype.renderFrame = UNDEFINED;\r\n\r\n\r\n/**\r\n * @param {module:ol/layer/Layer~State} state1 First layer state.\r\n * @param {module:ol/layer/Layer~State} state2 Second layer state.\r\n * @return {number} The zIndex difference.\r\n */\r\nexport function sortByZIndex(state1, state2) {\r\n  return state1.zIndex - state2.zIndex;\r\n}\r\nexport default MapRenderer;\r\n"],"names":["super","const","this","let"],"mappings":"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"}