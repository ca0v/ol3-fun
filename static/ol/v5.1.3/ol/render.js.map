{"version":3,"file":"render.js","sources":["../../src/ol/render.js"],"sourcesContent":["/**\r\n * @module ol/render\r\n */\r\nimport {DEVICE_PIXEL_RATIO} from './has.js';\r\nimport {create as createTransform, scale as scaleTransform} from './transform.js';\r\nimport CanvasImmediateRenderer from './render/canvas/Immediate.js';\r\n\r\n\r\n/**\r\n * @typedef {Object} State\r\n * @property {CanvasRenderingContext2D} context Canvas context that the layer is being rendered to.\r\n * @property {module:ol/Feature|module:ol/render/Feature} feature\r\n * @property {module:ol/geom/SimpleGeometry} geometry\r\n * @property {number} pixelRatio Pixel ratio used by the layer renderer.\r\n * @property {number} resolution Resolution that the render batch was created and optimized for.\r\n * This is not the view's resolution that is being rendered.\r\n * @property {number} rotation Rotation of the rendered layer in radians.\r\n */\r\n\r\n\r\n/**\r\n * A function to be used when sorting features before rendering.\r\n * It takes two instances of {@link module:ol/Feature} or\r\n * {@link module:ol/render/Feature} and returns a `{number}`.\r\n *\r\n * @typedef {function((module:ol/Feature|module:ol/render/Feature),\r\n *           (module:ol/Feature|module:ol/render/Feature)):number} OrderFunction\r\n */\r\n\r\n\r\n/**\r\n * @typedef {Object} ToContextOptions\r\n * @property {module:ol/size~Size} [size] Desired size of the canvas in css\r\n * pixels. When provided, both canvas and css size will be set according to the\r\n * `pixelRatio`. If not provided, the current canvas and css sizes will not be\r\n * altered.\r\n * @property {number} [pixelRatio=window.devicePixelRatio] Pixel ratio (canvas\r\n * pixel to css pixel ratio) for the canvas.\r\n */\r\n\r\n\r\n/**\r\n * Binds a Canvas Immediate API to a canvas context, to allow drawing geometries\r\n * to the context's canvas.\r\n *\r\n * The units for geometry coordinates are css pixels relative to the top left\r\n * corner of the canvas element.\r\n * ```js\r\n * import {toContext} from 'ol/render';\r\n * import Fill from 'ol/style/Fill';\r\n * import Polygon from 'ol/geom/Polygon';\r\n *\r\n * var canvas = document.createElement('canvas');\r\n * var render = toContext(canvas.getContext('2d'),\r\n *     { size: [100, 100] });\r\n * render.setFillStrokeStyle(new Fill({ color: blue }));\r\n * render.drawPolygon(\r\n *     new Polygon([[[0, 0], [100, 100], [100, 0], [0, 0]]]));\r\n * ```\r\n *\r\n * @param {CanvasRenderingContext2D} context Canvas context.\r\n * @param {module:ol/render~ToContextOptions=} opt_options Options.\r\n * @return {module:ol/render/canvas/Immediate} Canvas Immediate.\r\n * @api\r\n */\r\nexport function toContext(context, opt_options) {\r\n  const canvas = context.canvas;\r\n  const options = opt_options ? opt_options : {};\r\n  const pixelRatio = options.pixelRatio || DEVICE_PIXEL_RATIO;\r\n  const size = options.size;\r\n  if (size) {\r\n    canvas.width = size[0] * pixelRatio;\r\n    canvas.height = size[1] * pixelRatio;\r\n    canvas.style.width = size[0] + 'px';\r\n    canvas.style.height = size[1] + 'px';\r\n  }\r\n  const extent = [0, 0, canvas.width, canvas.height];\r\n  const transform = scaleTransform(createTransform(), pixelRatio, pixelRatio);\r\n  return new CanvasImmediateRenderer(context, pixelRatio, extent, transform, 0);\r\n}\r\n"],"names":["const"],"mappings":"AAAA;;;AAGA,QAAQ,kBAAkB,OAAO,UAAU,CAAC;AAC5C,QAAQ,MAAM,IAAI,eAAe,EAAE,KAAK,IAAI,cAAc,OAAO,gBAAgB,CAAC;AAClF,OAAO,uBAAuB,MAAM,8BAA8B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4DnE,OAAO,SAAS,SAAS,CAAC,OAAO,EAAE,WAAW,EAAE;EAC9CA,GAAK,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAC9BA,GAAK,CAAC,OAAO,GAAG,WAAW,GAAG,WAAW,GAAG,EAAE,CAAC;EAC/CA,GAAK,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,IAAI,kBAAkB,CAAC;EAC5DA,GAAK,CAAC,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAC1B,IAAI,IAAI,EAAE;IACR,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;IACpC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,UAAU,CAAC;IACrC,MAAM,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;IACpC,MAAM,CAAC,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;GACtC;EACDA,GAAK,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;EACnDA,GAAK,CAAC,SAAS,GAAG,cAAc,CAAC,eAAe,EAAE,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;EAC5E,OAAO,IAAI,uBAAuB,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;CAC/E;"}