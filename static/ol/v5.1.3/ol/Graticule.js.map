{"version":3,"file":"Graticule.js","sources":["../../src/ol/Graticule.js"],"sourcesContent":["/**\r\n * @module ol/Graticule\r\n */\r\nimport {degreesToStringHDMS} from './coordinate.js';\r\nimport {listen, unlistenByKey} from './events.js';\r\nimport {intersects, getCenter} from './extent.js';\r\nimport GeometryLayout from './geom/GeometryLayout.js';\r\nimport LineString from './geom/LineString.js';\r\nimport Point from './geom/Point.js';\r\nimport {meridian, parallel} from './geom/flat/geodesic.js';\r\nimport {clamp} from './math.js';\r\nimport {get as getProjection, equivalent as equivalentProjection, getTransform, transformExtent} from './proj.js';\r\nimport RenderEventType from './render/EventType.js';\r\nimport Fill from './style/Fill.js';\r\nimport Stroke from './style/Stroke.js';\r\nimport Text from './style/Text.js';\r\n\r\n\r\n/**\r\n * @type {module:ol/style/Stroke}\r\n * @private\r\n * @const\r\n */\r\nconst DEFAULT_STROKE_STYLE = new Stroke({\r\n  color: 'rgba(0,0,0,0.2)'\r\n});\r\n\r\n/**\r\n * TODO can be configurable\r\n * @type {Array.<number>}\r\n * @private\r\n */\r\nconst INTERVALS = [\r\n  90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001\r\n];\r\n\r\n/**\r\n * @typedef {Object} GraticuleLabelDataType\r\n * @property {module:ol/geom/Point} geom\r\n * @property {string} text\r\n */\r\n\r\n/**\r\n * @typedef {Object} Options\r\n * @property {module:ol/PluggableMap} [map] Reference to an\r\n * {@link module:ol/Map~Map} object.\r\n * @property {number} [maxLines=100] The maximum number of meridians and\r\n * parallels from the center of the map. The default value of 100 means that at\r\n * most 200 meridians and 200 parallels will be displayed. The default value is\r\n * appropriate for conformal projections like Spherical Mercator. If you\r\n * increase the value, more lines will be drawn and the drawing performance will\r\n * decrease.\r\n * @property {module:ol/style/Stroke} [strokeStyle='rgba(0,0,0,0.2)'] The\r\n * stroke style to use for drawing the graticule. If not provided, a not fully\r\n * opaque black will be used.\r\n * @property {number} [targetSize=100] The target size of the graticule cells,\r\n * in pixels.\r\n * @property {boolean} [showLabels=false] Render a label with the respective\r\n * latitude/longitude for each graticule line.\r\n * @property {function(number):string} [lonLabelFormatter] Label formatter for\r\n * longitudes. This function is called with the longitude as argument, and\r\n * should return a formatted string representing the longitude. By default,\r\n * labels are formatted as degrees, minutes, seconds and hemisphere.\r\n * @property {function(number):string} [latLabelFormatter] Label formatter for\r\n * latitudes. This function is called with the latitude as argument, and\r\n * should return a formatted string representing the latitude. By default,\r\n * labels are formatted as degrees, minutes, seconds and hemisphere.\r\n * @property {number} [lonLabelPosition=0] Longitude label position in fractions\r\n * (0..1) of view extent. 0 means at the bottom of the viewport, 1 means at the\r\n * top.\r\n * @property {number} [latLabelPosition=1] Latitude label position in fractions\r\n * (0..1) of view extent. 0 means at the left of the viewport, 1 means at the\r\n * right.\r\n * @property {module:ol/style/Text} [lonLabelStyle] Longitude label text\r\n * style. If not provided, the following style will be used:\r\n * ```js\r\n * new Text({\r\n *   font: '12px Calibri,sans-serif',\r\n *   textBaseline: 'bottom',\r\n *   fill: new Fill({\r\n *     color: 'rgba(0,0,0,1)'\r\n *   }),\r\n *   stroke: new Stroke({\r\n *     color: 'rgba(255,255,255,1)',\r\n *     width: 3\r\n *   })\r\n * });\r\n * ```\r\n * Note that the default's `textBaseline` configuration will not work well for\r\n * `lonLabelPosition` configurations that position labels close to the top of\r\n * the viewport.\r\n * @property {module:ol/style/Text} [latLabelStyle] Latitude label text style.\r\n * If not provided, the following style will be used:\r\n * ```js\r\n * new Text({\r\n *   font: '12px Calibri,sans-serif',\r\n *   textAlign: 'end',\r\n *   fill: new Fill({\r\n *     color: 'rgba(0,0,0,1)'\r\n *   }),\r\n *   stroke: Stroke({\r\n *     color: 'rgba(255,255,255,1)',\r\n *     width: 3\r\n *   })\r\n * });\r\n * ```\r\n * Note that the default's `textAlign` configuration will not work well for\r\n * `latLabelPosition` configurations that position labels close to the left of\r\n * the viewport.\r\n */\r\n\r\n\r\n/**\r\n * Render a grid for a coordinate system on a map.\r\n * @api\r\n */\r\nclass Graticule {\r\n\r\n  /**\r\n   * @param {module:ol/Graticule~Options=} opt_options Options.\r\n   */\r\n  constructor(opt_options) {\r\n    const options = opt_options || {};\r\n\r\n    /**\r\n     * @type {module:ol/PluggableMap}\r\n     * @private\r\n     */\r\n    this.map_ = null;\r\n\r\n    /**\r\n     * @type {?module:ol/events~EventsKey}\r\n     * @private\r\n     */\r\n    this.postcomposeListenerKey_ = null;\r\n\r\n    /**\r\n     * @type {module:ol/proj/Projection}\r\n     */\r\n    this.projection_ = null;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.maxLat_ = Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.maxLon_ = Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.minLat_ = -Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.minLon_ = -Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.maxLatP_ = Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.maxLonP_ = Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.minLatP_ = -Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.minLonP_ = -Infinity;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.targetSize_ = options.targetSize !== undefined ? options.targetSize : 100;\r\n\r\n    /**\r\n     * @type {number}\r\n     * @private\r\n     */\r\n    this.maxLines_ = options.maxLines !== undefined ? options.maxLines : 100;\r\n\r\n    /**\r\n     * @type {Array.<module:ol/geom/LineString>}\r\n     * @private\r\n     */\r\n    this.meridians_ = [];\r\n\r\n    /**\r\n     * @type {Array.<module:ol/geom/LineString>}\r\n     * @private\r\n     */\r\n    this.parallels_ = [];\r\n\r\n    /**\r\n     * @type {module:ol/style/Stroke}\r\n     * @private\r\n     */\r\n    this.strokeStyle_ = options.strokeStyle !== undefined ? options.strokeStyle : DEFAULT_STROKE_STYLE;\r\n\r\n    /**\r\n     * @type {module:ol/proj~TransformFunction|undefined}\r\n     * @private\r\n     */\r\n    this.fromLonLatTransform_ = undefined;\r\n\r\n    /**\r\n     * @type {module:ol/proj~TransformFunction|undefined}\r\n     * @private\r\n     */\r\n    this.toLonLatTransform_ = undefined;\r\n\r\n    /**\r\n     * @type {module:ol/coordinate~Coordinate}\r\n     * @private\r\n     */\r\n    this.projectionCenterLonLat_ = null;\r\n\r\n    /**\r\n     * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\r\n     * @private\r\n     */\r\n    this.meridiansLabels_ = null;\r\n\r\n    /**\r\n     * @type {Array.<module:ol/Graticule~GraticuleLabelDataType>}\r\n     * @private\r\n     */\r\n    this.parallelsLabels_ = null;\r\n\r\n    if (options.showLabels == true) {\r\n\r\n      /**\r\n       * @type {null|function(number):string}\r\n       * @private\r\n       */\r\n      this.lonLabelFormatter_ = options.lonLabelFormatter == undefined ?\r\n        degreesToStringHDMS.bind(this, 'EW') : options.lonLabelFormatter;\r\n\r\n      /**\r\n       * @type {function(number):string}\r\n       * @private\r\n       */\r\n      this.latLabelFormatter_ = options.latLabelFormatter == undefined ?\r\n        degreesToStringHDMS.bind(this, 'NS') : options.latLabelFormatter;\r\n\r\n      /**\r\n       * Longitude label position in fractions (0..1) of view extent. 0 means\r\n       * bottom, 1 means top.\r\n       * @type {number}\r\n       * @private\r\n       */\r\n      this.lonLabelPosition_ = options.lonLabelPosition == undefined ? 0 :\r\n        options.lonLabelPosition;\r\n\r\n      /**\r\n       * Latitude Label position in fractions (0..1) of view extent. 0 means left, 1\r\n       * means right.\r\n       * @type {number}\r\n       * @private\r\n       */\r\n      this.latLabelPosition_ = options.latLabelPosition == undefined ? 1 :\r\n        options.latLabelPosition;\r\n\r\n      /**\r\n       * @type {module:ol/style/Text}\r\n       * @private\r\n       */\r\n      this.lonLabelStyle_ = options.lonLabelStyle !== undefined ? options.lonLabelStyle :\r\n        new Text({\r\n          font: '12px Calibri,sans-serif',\r\n          textBaseline: 'bottom',\r\n          fill: new Fill({\r\n            color: 'rgba(0,0,0,1)'\r\n          }),\r\n          stroke: new Stroke({\r\n            color: 'rgba(255,255,255,1)',\r\n            width: 3\r\n          })\r\n        });\r\n\r\n      /**\r\n       * @type {module:ol/style/Text}\r\n       * @private\r\n       */\r\n      this.latLabelStyle_ = options.latLabelStyle !== undefined ? options.latLabelStyle :\r\n        new Text({\r\n          font: '12px Calibri,sans-serif',\r\n          textAlign: 'end',\r\n          fill: new Fill({\r\n            color: 'rgba(0,0,0,1)'\r\n          }),\r\n          stroke: new Stroke({\r\n            color: 'rgba(255,255,255,1)',\r\n            width: 3\r\n          })\r\n        });\r\n\r\n      this.meridiansLabels_ = [];\r\n      this.parallelsLabels_ = [];\r\n    }\r\n\r\n    this.setMap(options.map !== undefined ? options.map : null);\r\n  }\r\n\r\n  /**\r\n   * @param {number} lon Longitude.\r\n   * @param {number} minLat Minimal latitude.\r\n   * @param {number} maxLat Maximal latitude.\r\n   * @param {number} squaredTolerance Squared tolerance.\r\n   * @param {module:ol/extent~Extent} extent Extent.\r\n   * @param {number} index Index.\r\n   * @return {number} Index.\r\n   * @private\r\n   */\r\n  addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, index) {\r\n    const lineString = this.getMeridian_(lon, minLat, maxLat, squaredTolerance, index);\r\n    if (intersects(lineString.getExtent(), extent)) {\r\n      if (this.meridiansLabels_) {\r\n        const textPoint = this.getMeridianPoint_(lineString, extent, index);\r\n        this.meridiansLabels_[index] = {\r\n          geom: textPoint,\r\n          text: this.lonLabelFormatter_(lon)\r\n        };\r\n      }\r\n      this.meridians_[index++] = lineString;\r\n    }\r\n    return index;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/geom/LineString} lineString Meridian\r\n   * @param {module:ol/extent~Extent} extent Extent.\r\n   * @param {number} index Index.\r\n   * @return {module:ol/geom/Point} Meridian point.\r\n   * @private\r\n   */\r\n  getMeridianPoint_(lineString, extent, index) {\r\n    const flatCoordinates = lineString.getFlatCoordinates();\r\n    const clampedBottom = Math.max(extent[1], flatCoordinates[1]);\r\n    const clampedTop = Math.min(extent[3], flatCoordinates[flatCoordinates.length - 1]);\r\n    const lat = clamp(\r\n      extent[1] + Math.abs(extent[1] - extent[3]) * this.lonLabelPosition_,\r\n      clampedBottom, clampedTop);\r\n    const coordinate = [flatCoordinates[0], lat];\r\n    let point;\r\n    if (index in this.meridiansLabels_) {\r\n      point = this.meridiansLabels_[index];\r\n      point.setCoordinates(coordinate);\r\n    } else {\r\n      point = new Point(coordinate);\r\n    }\r\n    return point;\r\n  }\r\n\r\n  /**\r\n   * @param {number} lat Latitude.\r\n   * @param {number} minLon Minimal longitude.\r\n   * @param {number} maxLon Maximal longitude.\r\n   * @param {number} squaredTolerance Squared tolerance.\r\n   * @param {module:ol/extent~Extent} extent Extent.\r\n   * @param {number} index Index.\r\n   * @return {number} Index.\r\n   * @private\r\n   */\r\n  addParallel_(lat, minLon, maxLon, squaredTolerance, extent, index) {\r\n    const lineString = this.getParallel_(lat, minLon, maxLon, squaredTolerance, index);\r\n    if (intersects(lineString.getExtent(), extent)) {\r\n      if (this.parallelsLabels_) {\r\n        const textPoint = this.getParallelPoint_(lineString, extent, index);\r\n        this.parallelsLabels_[index] = {\r\n          geom: textPoint,\r\n          text: this.latLabelFormatter_(lat)\r\n        };\r\n      }\r\n      this.parallels_[index++] = lineString;\r\n    }\r\n    return index;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/geom/LineString} lineString Parallels.\r\n   * @param {module:ol/extent~Extent} extent Extent.\r\n   * @param {number} index Index.\r\n   * @return {module:ol/geom/Point} Parallel point.\r\n   * @private\r\n   */\r\n  getParallelPoint_(lineString, extent, index) {\r\n    const flatCoordinates = lineString.getFlatCoordinates();\r\n    const clampedLeft = Math.max(extent[0], flatCoordinates[0]);\r\n    const clampedRight = Math.min(extent[2], flatCoordinates[flatCoordinates.length - 2]);\r\n    const lon = clamp(\r\n      extent[0] + Math.abs(extent[0] - extent[2]) * this.latLabelPosition_,\r\n      clampedLeft, clampedRight);\r\n    const coordinate = [lon, flatCoordinates[1]];\r\n    let point;\r\n    if (index in this.parallelsLabels_) {\r\n      point = this.parallelsLabels_[index];\r\n      point.setCoordinates(coordinate);\r\n    } else {\r\n      point = new Point(coordinate);\r\n    }\r\n    return point;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/extent~Extent} extent Extent.\r\n   * @param {module:ol/coordinate~Coordinate} center Center.\r\n   * @param {number} resolution Resolution.\r\n   * @param {number} squaredTolerance Squared tolerance.\r\n   * @private\r\n   */\r\n  createGraticule_(extent, center, resolution, squaredTolerance) {\r\n\r\n    const interval = this.getInterval_(resolution);\r\n    if (interval == -1) {\r\n      this.meridians_.length = this.parallels_.length = 0;\r\n      if (this.meridiansLabels_) {\r\n        this.meridiansLabels_.length = 0;\r\n      }\r\n      if (this.parallelsLabels_) {\r\n        this.parallelsLabels_.length = 0;\r\n      }\r\n      return;\r\n    }\r\n\r\n    const centerLonLat = this.toLonLatTransform_(center);\r\n    let centerLon = centerLonLat[0];\r\n    let centerLat = centerLonLat[1];\r\n    const maxLines = this.maxLines_;\r\n    let cnt, idx, lat, lon;\r\n\r\n    let validExtent = [\r\n      Math.max(extent[0], this.minLonP_),\r\n      Math.max(extent[1], this.minLatP_),\r\n      Math.min(extent[2], this.maxLonP_),\r\n      Math.min(extent[3], this.maxLatP_)\r\n    ];\r\n\r\n    validExtent = transformExtent(validExtent, this.projection_, 'EPSG:4326');\r\n    const maxLat = validExtent[3];\r\n    const maxLon = validExtent[2];\r\n    const minLat = validExtent[1];\r\n    const minLon = validExtent[0];\r\n\r\n    // Create meridians\r\n\r\n    centerLon = Math.floor(centerLon / interval) * interval;\r\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\r\n\r\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, 0);\r\n\r\n    cnt = 0;\r\n    while (lon != this.minLon_ && cnt++ < maxLines) {\r\n      lon = Math.max(lon - interval, this.minLon_);\r\n      idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\r\n    }\r\n\r\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\r\n\r\n    cnt = 0;\r\n    while (lon != this.maxLon_ && cnt++ < maxLines) {\r\n      lon = Math.min(lon + interval, this.maxLon_);\r\n      idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\r\n    }\r\n\r\n    this.meridians_.length = idx;\r\n    if (this.meridiansLabels_) {\r\n      this.meridiansLabels_.length = idx;\r\n    }\r\n\r\n    // Create parallels\r\n\r\n    centerLat = Math.floor(centerLat / interval) * interval;\r\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\r\n\r\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, 0);\r\n\r\n    cnt = 0;\r\n    while (lat != this.minLat_ && cnt++ < maxLines) {\r\n      lat = Math.max(lat - interval, this.minLat_);\r\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\r\n    }\r\n\r\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\r\n\r\n    cnt = 0;\r\n    while (lat != this.maxLat_ && cnt++ < maxLines) {\r\n      lat = Math.min(lat + interval, this.maxLat_);\r\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\r\n    }\r\n\r\n    this.parallels_.length = idx;\r\n    if (this.parallelsLabels_) {\r\n      this.parallelsLabels_.length = idx;\r\n    }\r\n\r\n  }\r\n\r\n  /**\r\n   * @param {number} resolution Resolution.\r\n   * @return {number} The interval in degrees.\r\n   * @private\r\n   */\r\n  getInterval_(resolution) {\r\n    const centerLon = this.projectionCenterLonLat_[0];\r\n    const centerLat = this.projectionCenterLonLat_[1];\r\n    let interval = -1;\r\n    const target = Math.pow(this.targetSize_ * resolution, 2);\r\n    /** @type {Array.<number>} **/\r\n    const p1 = [];\r\n    /** @type {Array.<number>} **/\r\n    const p2 = [];\r\n    for (let i = 0, ii = INTERVALS.length; i < ii; ++i) {\r\n      const delta = INTERVALS[i] / 2;\r\n      p1[0] = centerLon - delta;\r\n      p1[1] = centerLat - delta;\r\n      p2[0] = centerLon + delta;\r\n      p2[1] = centerLat + delta;\r\n      this.fromLonLatTransform_(p1, p1);\r\n      this.fromLonLatTransform_(p2, p2);\r\n      const dist = Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2);\r\n      if (dist <= target) {\r\n        break;\r\n      }\r\n      interval = INTERVALS[i];\r\n    }\r\n    return interval;\r\n  }\r\n\r\n  /**\r\n   * Get the map associated with this graticule.\r\n   * @return {module:ol/PluggableMap} The map.\r\n   * @api\r\n   */\r\n  getMap() {\r\n    return this.map_;\r\n  }\r\n\r\n  /**\r\n   * @param {number} lon Longitude.\r\n   * @param {number} minLat Minimal latitude.\r\n   * @param {number} maxLat Maximal latitude.\r\n   * @param {number} squaredTolerance Squared tolerance.\r\n   * @return {module:ol/geom/LineString} The meridian line string.\r\n   * @param {number} index Index.\r\n   * @private\r\n   */\r\n  getMeridian_(lon, minLat, maxLat, squaredTolerance, index) {\r\n    const flatCoordinates = meridian(lon, minLat, maxLat, this.projection_, squaredTolerance);\r\n    let lineString = this.meridians_[index];\r\n    if (!lineString) {\r\n      lineString = this.meridians_[index] = new LineString(flatCoordinates, GeometryLayout.XY);\r\n    } else {\r\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\r\n      lineString.changed();\r\n    }\r\n    return lineString;\r\n  }\r\n\r\n  /**\r\n   * Get the list of meridians.  Meridians are lines of equal longitude.\r\n   * @return {Array.<module:ol/geom/LineString>} The meridians.\r\n   * @api\r\n   */\r\n  getMeridians() {\r\n    return this.meridians_;\r\n  }\r\n\r\n  /**\r\n   * @param {number} lat Latitude.\r\n   * @param {number} minLon Minimal longitude.\r\n   * @param {number} maxLon Maximal longitude.\r\n   * @param {number} squaredTolerance Squared tolerance.\r\n   * @return {module:ol/geom/LineString} The parallel line string.\r\n   * @param {number} index Index.\r\n   * @private\r\n   */\r\n  getParallel_(lat, minLon, maxLon, squaredTolerance, index) {\r\n    const flatCoordinates = parallel(lat, minLon, maxLon, this.projection_, squaredTolerance);\r\n    let lineString = this.parallels_[index];\r\n    if (!lineString) {\r\n      lineString = new LineString(flatCoordinates, GeometryLayout.XY);\r\n    } else {\r\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\r\n      lineString.changed();\r\n    }\r\n    return lineString;\r\n  }\r\n\r\n  /**\r\n   * Get the list of parallels.  Parallels are lines of equal latitude.\r\n   * @return {Array.<module:ol/geom/LineString>} The parallels.\r\n   * @api\r\n   */\r\n  getParallels() {\r\n    return this.parallels_;\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/render/Event} e Event.\r\n   * @private\r\n   */\r\n  handlePostCompose_(e) {\r\n    const vectorContext = e.vectorContext;\r\n    const frameState = e.frameState;\r\n    const extent = frameState.extent;\r\n    const viewState = frameState.viewState;\r\n    const center = viewState.center;\r\n    const projection = viewState.projection;\r\n    const resolution = viewState.resolution;\r\n    const pixelRatio = frameState.pixelRatio;\r\n    const squaredTolerance =\r\n        resolution * resolution / (4 * pixelRatio * pixelRatio);\r\n\r\n    const updateProjectionInfo = !this.projection_ ||\r\n        !equivalentProjection(this.projection_, projection);\r\n\r\n    if (updateProjectionInfo) {\r\n      this.updateProjectionInfo_(projection);\r\n    }\r\n\r\n    this.createGraticule_(extent, center, resolution, squaredTolerance);\r\n\r\n    // Draw the lines\r\n    vectorContext.setFillStrokeStyle(null, this.strokeStyle_);\r\n    let i, l, line;\r\n    for (i = 0, l = this.meridians_.length; i < l; ++i) {\r\n      line = this.meridians_[i];\r\n      vectorContext.drawGeometry(line);\r\n    }\r\n    for (i = 0, l = this.parallels_.length; i < l; ++i) {\r\n      line = this.parallels_[i];\r\n      vectorContext.drawGeometry(line);\r\n    }\r\n    let labelData;\r\n    if (this.meridiansLabels_) {\r\n      for (i = 0, l = this.meridiansLabels_.length; i < l; ++i) {\r\n        labelData = this.meridiansLabels_[i];\r\n        this.lonLabelStyle_.setText(labelData.text);\r\n        vectorContext.setTextStyle(this.lonLabelStyle_);\r\n        vectorContext.drawGeometry(labelData.geom);\r\n      }\r\n    }\r\n    if (this.parallelsLabels_) {\r\n      for (i = 0, l = this.parallelsLabels_.length; i < l; ++i) {\r\n        labelData = this.parallelsLabels_[i];\r\n        this.latLabelStyle_.setText(labelData.text);\r\n        vectorContext.setTextStyle(this.latLabelStyle_);\r\n        vectorContext.drawGeometry(labelData.geom);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {module:ol/proj/Projection} projection Projection.\r\n   * @private\r\n   */\r\n  updateProjectionInfo_(projection) {\r\n    const epsg4326Projection = getProjection('EPSG:4326');\r\n\r\n    const worldExtent = projection.getWorldExtent();\r\n    const worldExtentP = transformExtent(worldExtent, epsg4326Projection, projection);\r\n\r\n    this.maxLat_ = worldExtent[3];\r\n    this.maxLon_ = worldExtent[2];\r\n    this.minLat_ = worldExtent[1];\r\n    this.minLon_ = worldExtent[0];\r\n\r\n    this.maxLatP_ = worldExtentP[3];\r\n    this.maxLonP_ = worldExtentP[2];\r\n    this.minLatP_ = worldExtentP[1];\r\n    this.minLonP_ = worldExtentP[0];\r\n\r\n    this.fromLonLatTransform_ = getTransform(epsg4326Projection, projection);\r\n\r\n    this.toLonLatTransform_ = getTransform(projection, epsg4326Projection);\r\n\r\n    this.projectionCenterLonLat_ = this.toLonLatTransform_(getCenter(projection.getExtent()));\r\n\r\n    this.projection_ = projection;\r\n  }\r\n\r\n  /**\r\n   * Set the map for this graticule.  The graticule will be rendered on the\r\n   * provided map.\r\n   * @param {module:ol/PluggableMap} map Map.\r\n   * @api\r\n   */\r\n  setMap(map) {\r\n    if (this.map_) {\r\n      unlistenByKey(this.postcomposeListenerKey_);\r\n      this.postcomposeListenerKey_ = null;\r\n      this.map_.render();\r\n    }\r\n    if (map) {\r\n      this.postcomposeListenerKey_ = listen(map, RenderEventType.POSTCOMPOSE, this.handlePostCompose_, this);\r\n      map.render();\r\n    }\r\n    this.map_ = map;\r\n  }\r\n}\r\n\r\nexport default Graticule;\r\n"],"names":["const","let","this"],"mappings":"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"}