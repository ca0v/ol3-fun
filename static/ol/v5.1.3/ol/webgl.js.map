{"version":3,"file":"webgl.js","sources":["../../src/ol/webgl.js"],"sourcesContent":["/**\r\n * @module ol/webgl\r\n */\r\n\r\n\r\n/**\r\n * Constants taken from goog.webgl\r\n */\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const ONE = 1;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const SRC_ALPHA = 0x0302;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const COLOR_ATTACHMENT0 = 0x8CE0;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const COLOR_BUFFER_BIT = 0x00004000;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TRIANGLES = 0x0004;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TRIANGLE_STRIP = 0x0005;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const ONE_MINUS_SRC_ALPHA = 0x0303;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const ARRAY_BUFFER = 0x8892;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const ELEMENT_ARRAY_BUFFER = 0x8893;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const STREAM_DRAW = 0x88E0;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const STATIC_DRAW = 0x88E4;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const DYNAMIC_DRAW = 0x88E8;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const CULL_FACE = 0x0B44;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const BLEND = 0x0BE2;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const STENCIL_TEST = 0x0B90;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const DEPTH_TEST = 0x0B71;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const SCISSOR_TEST = 0x0C11;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const UNSIGNED_BYTE = 0x1401;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const UNSIGNED_SHORT = 0x1403;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const UNSIGNED_INT = 0x1405;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const FLOAT = 0x1406;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const RGBA = 0x1908;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const FRAGMENT_SHADER = 0x8B30;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const VERTEX_SHADER = 0x8B31;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const LINK_STATUS = 0x8B82;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const LINEAR = 0x2601;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE_MAG_FILTER = 0x2800;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE_MIN_FILTER = 0x2801;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE_WRAP_S = 0x2802;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE_WRAP_T = 0x2803;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE_2D = 0x0DE1;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const TEXTURE0 = 0x84C0;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const CLAMP_TO_EDGE = 0x812F;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const COMPILE_STATUS = 0x8B81;\r\n\r\n\r\n/**\r\n * @const\r\n * @type {number}\r\n */\r\nexport const FRAMEBUFFER = 0x8D40;\r\n\r\n\r\n/** end of goog.webgl constants\r\n */\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Array.<string>}\r\n */\r\nconst CONTEXT_IDS = [\r\n  'experimental-webgl',\r\n  'webgl',\r\n  'webkit-3d',\r\n  'moz-webgl'\r\n];\r\n\r\n\r\n/**\r\n * @param {HTMLCanvasElement} canvas Canvas.\r\n * @param {Object=} opt_attributes Attributes.\r\n * @return {WebGLRenderingContext} WebGL rendering context.\r\n */\r\nexport function getContext(canvas, opt_attributes) {\r\n  const ii = CONTEXT_IDS.length;\r\n  for (let i = 0; i < ii; ++i) {\r\n    try {\r\n      const context = canvas.getContext(CONTEXT_IDS[i], opt_attributes);\r\n      if (context) {\r\n        return /** @type {!WebGLRenderingContext} */ (context);\r\n      }\r\n    } catch (e) {\r\n      // pass\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n\r\n/**\r\n * Include debuggable shader sources.  Default is `true`. This should be set to\r\n * `false` for production builds.\r\n * @type {boolean}\r\n */\r\nexport const DEBUG = true;\r\n\r\n\r\n/**\r\n * The maximum supported WebGL texture size in pixels. If WebGL is not\r\n * supported, the value is set to `undefined`.\r\n * @type {number|undefined}\r\n */\r\nlet MAX_TEXTURE_SIZE; // value is set below\r\n\r\n\r\n/**\r\n * List of supported WebGL extensions.\r\n * @type {Array.<string>}\r\n */\r\nlet EXTENSIONS; // value is set below\r\n\r\n\r\n/**\r\n * True if both OpenLayers and browser support WebGL.\r\n * @type {boolean}\r\n * @api\r\n */\r\nlet HAS = false;\r\n\r\n//TODO Remove side effects\r\nif (typeof window !== 'undefined' && 'WebGLRenderingContext' in window) {\r\n  try {\r\n    const canvas = /** @type {HTMLCanvasElement} */ (document.createElement('CANVAS'));\r\n    const gl = getContext(canvas, {failIfMajorPerformanceCaveat: true});\r\n    if (gl) {\r\n      HAS = true;\r\n      MAX_TEXTURE_SIZE = /** @type {number} */ (gl.getParameter(gl.MAX_TEXTURE_SIZE));\r\n      EXTENSIONS = gl.getSupportedExtensions();\r\n    }\r\n  } catch (e) {\r\n    // pass\r\n  }\r\n}\r\n\r\nexport {HAS, MAX_TEXTURE_SIZE, EXTENSIONS};\r\n"],"names":["const","let"],"mappings":"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"}