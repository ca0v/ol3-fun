{"version":3,"file":"DragZoom.js","sources":["../../../src/ol/interaction/DragZoom.js"],"sourcesContent":["/**\r\n * @module ol/interaction/DragZoom\r\n */\r\nimport {easeOut} from '../easing.js';\r\nimport {shiftKeyOnly} from '../events/condition.js';\r\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\r\nimport DragBox from '../interaction/DragBox.js';\r\n\r\n\r\n/**\r\n * @typedef {Object} Options\r\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\r\n * box.\r\n * @property {module:ol/events/condition~Condition} [condition] A function that\r\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\r\n * boolean to indicate whether that event should be handled.\r\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\r\n * @property {number} [duration=200] Animation duration in milliseconds.\r\n * @property {boolean} [out=false] Use interaction for zooming out.\r\n */\r\n\r\n\r\n/**\r\n * @classdesc\r\n * Allows the user to zoom the map by clicking and dragging on the map,\r\n * normally combined with an {@link module:ol/events/condition} that limits\r\n * it to when a key, shift by default, is held down.\r\n *\r\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\r\n * your custom one configured with `className`.\r\n * @api\r\n */\r\nclass DragZoom extends DragBox {\r\n  /**\r\n   * @param {module:ol/interaction/DragZoom~Options=} opt_options Options.\r\n   */\r\n  constructor(opt_options) {\r\n    const options = opt_options ? opt_options : {};\r\n\r\n    const condition = options.condition ? options.condition : shiftKeyOnly;\r\n\r\n    super({\r\n      condition: condition,\r\n      className: options.className || 'ol-dragzoom',\r\n      onBoxEnd: onBoxEnd\r\n    });\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.duration_ = options.duration !== undefined ? options.duration : 200;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.out_ = options.out !== undefined ? options.out : false;\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @this {module:ol/interaction/DragZoom}\r\n */\r\nfunction onBoxEnd() {\r\n  const map = this.getMap();\r\n  const view = /** @type {!module:ol/View} */ (map.getView());\r\n  const size = /** @type {!module:ol/size~Size} */ (map.getSize());\r\n  let extent = this.getGeometry().getExtent();\r\n\r\n  if (this.out_) {\r\n    const mapExtent = view.calculateExtent(size);\r\n    const boxPixelExtent = createOrUpdateFromCoordinates([\r\n      map.getPixelFromCoordinate(getBottomLeft(extent)),\r\n      map.getPixelFromCoordinate(getTopRight(extent))]);\r\n    const factor = view.getResolutionForExtent(boxPixelExtent, size);\r\n\r\n    scaleFromCenter(mapExtent, 1 / factor);\r\n    extent = mapExtent;\r\n  }\r\n\r\n  const resolution = view.constrainResolution(\r\n    view.getResolutionForExtent(extent, size));\r\n\r\n  let center = getCenter(extent);\r\n  center = view.constrainCenter(center);\r\n\r\n  view.animate({\r\n    resolution: resolution,\r\n    center: center,\r\n    duration: this.duration_,\r\n    easing: easeOut\r\n  });\r\n}\r\n\r\n\r\nexport default DragZoom;\r\n"],"names":["const","super","let"],"mappings":"AAAA;;;AAGA,QAAQ,OAAO,OAAO,cAAc,CAAC;AACrC,QAAQ,YAAY,OAAO,wBAAwB,CAAC;AACpD,QAAQ,6BAA6B,EAAE,aAAa,EAAE,SAAS,EAAE,WAAW,EAAE,eAAe,OAAO,cAAc,CAAC;AACnH,OAAO,OAAO,MAAM,2BAA2B,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;AA0BhD,IAAM,QAAQ,GAAgB;EAI5B,iBAAW,CAAC,WAAW,EAAE;IACvBA,GAAK,CAAC,OAAO,GAAG,WAAW,GAAG,WAAW,GAAG,EAAE,CAAC;;IAE/CA,GAAK,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,SAAS,GAAG,YAAY,CAAC;;IAEvEC,YAAK,OAAC;MACJ,SAAS,EAAE,SAAS;MACpB,SAAS,EAAE,OAAO,CAAC,SAAS,IAAI,aAAa;MAC7C,QAAQ,EAAE,QAAQ;KACnB,CAAC,CAAC;;;;;;IAMH,IAAI,CAAC,SAAS,GAAG,OAAO,CAAC,QAAQ,KAAK,SAAS,GAAG,OAAO,CAAC,QAAQ,GAAG,GAAG,CAAC;;;;;;IAMzE,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,GAAG,KAAK,SAAS,GAAG,OAAO,CAAC,GAAG,GAAG,KAAK,CAAC;;;;;GAC7D;;;EA1BoB,UA2BtB;;;;;;AAMD,SAAS,QAAQ,GAAG;EAClBD,GAAK,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;EAC1BA,GAAK,CAAC,IAAI,kCAAkC,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;EAC5DA,GAAK,CAAC,IAAI,uCAAuC,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;EACjEE,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC,SAAS,EAAE,CAAC;;EAE5C,IAAI,IAAI,CAAC,IAAI,EAAE;IACbF,GAAK,CAAC,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;IAC7CA,GAAK,CAAC,cAAc,GAAG,6BAA6B,CAAC;MACnD,GAAG,CAAC,sBAAsB,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;MACjD,GAAG,CAAC,sBAAsB,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IACpDA,GAAK,CAAC,MAAM,GAAG,IAAI,CAAC,sBAAsB,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;;IAEjE,eAAe,CAAC,SAAS,EAAE,CAAC,GAAG,MAAM,CAAC,CAAC;IACvC,MAAM,GAAG,SAAS,CAAC;GACpB;;EAEDA,GAAK,CAAC,UAAU,GAAG,IAAI,CAAC,mBAAmB;IACzC,IAAI,CAAC,sBAAsB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;;EAE7CE,GAAG,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;EAC/B,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;;EAEtC,IAAI,CAAC,OAAO,CAAC;IACX,UAAU,EAAE,UAAU;IACtB,MAAM,EAAE,MAAM;IACd,QAAQ,EAAE,IAAI,CAAC,SAAS;IACxB,MAAM,EAAE,OAAO;GAChB,CAAC,CAAC;CACJ;;;AAGD,eAAe,QAAQ,CAAC;"}