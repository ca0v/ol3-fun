{"version":3,"file":"MsSource.js","sources":["../../../src/ol/pointer/MsSource.js"],"sourcesContent":["/**\r\n * @module ol/pointer/MsSource\r\n */\r\n// Based on https://github.com/Polymer/PointerEvents\r\n\r\n// Copyright (c) 2013 The Polymer Authors. All rights reserved.\r\n//\r\n// Redistribution and use in source and binary forms, with or without\r\n// modification, are permitted provided that the following conditions are\r\n// met:\r\n//\r\n// * Redistributions of source code must retain the above copyright\r\n// notice, this list of conditions and the following disclaimer.\r\n// * Redistributions in binary form must reproduce the above\r\n// copyright notice, this list of conditions and the following disclaimer\r\n// in the documentation and/or other materials provided with the\r\n// distribution.\r\n// * Neither the name of Google Inc. nor the names of its\r\n// contributors may be used to endorse or promote products derived from\r\n// this software without specific prior written permission.\r\n//\r\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\r\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\r\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\r\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\r\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\r\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\r\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\r\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\r\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\r\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n\r\nimport EventSource from '../pointer/EventSource.js';\r\n\r\n\r\n/**\r\n * @const\r\n * @type {Array.<string>}\r\n */\r\nconst POINTER_TYPES = [\r\n  '',\r\n  'unavailable',\r\n  'touch',\r\n  'pen',\r\n  'mouse'\r\n];\r\n\r\n/**\r\n * Handler for `msPointerDown`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerDown(inEvent) {\r\n  this.pointerMap[inEvent.pointerId.toString()] = inEvent;\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.down(e, inEvent);\r\n}\r\n\r\n/**\r\n * Handler for `msPointerMove`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerMove(inEvent) {\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.move(e, inEvent);\r\n}\r\n\r\n/**\r\n * Handler for `msPointerUp`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerUp(inEvent) {\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.up(e, inEvent);\r\n  this.cleanup(inEvent.pointerId);\r\n}\r\n\r\n/**\r\n * Handler for `msPointerOut`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerOut(inEvent) {\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.leaveOut(e, inEvent);\r\n}\r\n\r\n/**\r\n * Handler for `msPointerOver`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerOver(inEvent) {\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.enterOver(e, inEvent);\r\n}\r\n\r\n/**\r\n * Handler for `msPointerCancel`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msPointerCancel(inEvent) {\r\n  const e = this.prepareEvent_(inEvent);\r\n  this.dispatcher.cancel(e, inEvent);\r\n  this.cleanup(inEvent.pointerId);\r\n}\r\n\r\n/**\r\n * Handler for `msLostPointerCapture`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msLostPointerCapture(inEvent) {\r\n  const e = this.dispatcher.makeEvent('lostpointercapture', inEvent, inEvent);\r\n  this.dispatcher.dispatchEvent(e);\r\n}\r\n\r\n/**\r\n * Handler for `msGotPointerCapture`.\r\n *\r\n * @this {module:ol/pointer/MsSource}\r\n * @param {MSPointerEvent} inEvent The in event.\r\n */\r\nfunction msGotPointerCapture(inEvent) {\r\n  const e = this.dispatcher.makeEvent('gotpointercapture', inEvent, inEvent);\r\n  this.dispatcher.dispatchEvent(e);\r\n}\r\n\r\nclass MsSource extends EventSource {\r\n\r\n  /**\r\n   * @param {module:ol/pointer/PointerEventHandler} dispatcher Event handler.\r\n   */\r\n  constructor(dispatcher) {\r\n    const mapping = {\r\n      'MSPointerDown': msPointerDown,\r\n      'MSPointerMove': msPointerMove,\r\n      'MSPointerUp': msPointerUp,\r\n      'MSPointerOut': msPointerOut,\r\n      'MSPointerOver': msPointerOver,\r\n      'MSPointerCancel': msPointerCancel,\r\n      'MSGotPointerCapture': msGotPointerCapture,\r\n      'MSLostPointerCapture': msLostPointerCapture\r\n    };\r\n    super(dispatcher, mapping);\r\n\r\n    /**\r\n     * @const\r\n     * @type {!Object.<string, MSPointerEvent|Object>}\r\n     */\r\n    this.pointerMap = dispatcher.pointerMap;\r\n  }\r\n\r\n  /**\r\n   * Creates a copy of the original event that will be used\r\n   * for the fake pointer event.\r\n   *\r\n   * @private\r\n   * @param {MSPointerEvent} inEvent The in event.\r\n   * @return {Object} The copied event.\r\n   */\r\n  prepareEvent_(inEvent) {\r\n    let e = inEvent;\r\n    if (typeof inEvent.pointerType === 'number') {\r\n      e = this.dispatcher.cloneEvent(inEvent, inEvent);\r\n      e.pointerType = POINTER_TYPES[inEvent.pointerType];\r\n    }\r\n\r\n    return e;\r\n  }\r\n\r\n  /**\r\n   * Remove this pointer from the list of active pointers.\r\n   * @param {number} pointerId Pointer identifier.\r\n   */\r\n  cleanup(pointerId) {\r\n    delete this.pointerMap[pointerId.toString()];\r\n  }\r\n\r\n}\r\n\r\nexport default MsSource;\r\n"],"names":["const","super","let"],"mappings":"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"}